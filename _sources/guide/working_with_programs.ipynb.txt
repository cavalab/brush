{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "e9776d12",
   "metadata": {},
   "source": [
    "# Working with Programs\n",
    "\n",
    "In Brush, a *Program* is an executable data structure. \n",
    "You may think of it as a *model* or a *function* mapping feature inputs to data labels. \n",
    "We call them programs because that's what they are: executable data structures,  \n",
    "and that is what they are called in the genetic algorithm literature, to distinguish them from optimizing bits or strings. \n",
    "\n",
    "The Brush Program class operates similarly to a [sklearn](scikit-learn.org) estimator: it has `fit` and `predict` methods that are called in during training or inference, respectively. \n",
    "\n",
    "\n",
    "## Types of Programs \n",
    "\n",
    "There are four fundamental \"types\" of Brush programs:\n",
    "\n",
    "- **Regressors**: map inputs to a continous endpoint \n",
    "- **Binary Classifiers**: map inputs to a binary endpoint, as well as a continuous value in $[0, 1]$  \n",
    "- **Multi-class Classifiers**: map inputs to a category\n",
    "    - Under development\n",
    "- **Representors**: map inputs to a lower dimensional space. \n",
    "    - Under development\n",
    "\n",
    "## Representation \n",
    "\n",
    "Internally, the programs are represented as syntax trees. \n",
    "We use the [tree.hh tree class](https://github.com/kpeeters/tree.hh) which gives trees an STL-like feel. \n",
    "\n",
    "\n",
    "\n",
    "## Generation\n",
    "\n",
    "We generate random programs using Sean Luke's PTC2 algorithm.  \n",
    "\n",
    "\n",
    "## Evaluation\n",
    "\n",
    "TODO\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8c258669",
   "metadata": {},
   "source": [
    "## Visualizing Programs\n",
    "\n",
    "Programs in Brush are symbolic tree structures, and can be viewed in a few ways: \n",
    "\n",
    "\n",
    "1. As a string using `get_model()`\n",
    "2. As a string-like tree using `get_model(\"tree\")`\n",
    "2. As a graph using `graphviz` and `get_model(\"dot\")`. \n",
    "\n",
    "Let's look at a regresion example."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "102e3fcb",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "from pybrush import BrushRegressor\n",
    "\n",
    "# load data\n",
    "df = pd.read_csv('../examples/datasets/d_enc.csv')\n",
    "X = df.drop(columns='label')\n",
    "y = df['label']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "ac39c9ca",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Completed 100% [====================]\n",
      "saving final population as archive...\n",
      "score: 0.9692734718285546\n"
     ]
    }
   ],
   "source": [
    "# import and make a regressor\n",
    "est = BrushRegressor(\n",
    "    functions=['SplitBest','Mul','Add','Cos','Exp','Sin'],\n",
    "    verbosity=1 # set verbosity==1 to see a progress bar\n",
    ")\n",
    "\n",
    "# use like you would a sklearn regressor\n",
    "est.fit(X,y)\n",
    "y_pred = est.predict(X)\n",
    "print('score:', est.score(X,y))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5bbd24cd",
   "metadata": {},
   "source": [
    "You can see the fitness of the final individual by accessing the `fitness` attribute. Each fitness value corresponds to the objective of same index defined earlier for the `BrushRegressor` class. By default, it will try to minimize `\"scorer\"` and `\"size\"`, where `scorer` is a string with a loss function name, set with `scorer` parameter."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "166415c2",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Fitness(2.777221 175.000000 )\n",
      "['scorer', 'linear_complexity']\n"
     ]
    }
   ],
   "source": [
    "print(est.best_estimator_.fitness)\n",
    "print(est.objectives)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "38b6364e",
   "metadata": {},
   "source": [
    "A `fitness` in Brush is actually more than a tuple. It is a class that has all boolean comparison operators overloaded to allow an ease of use when prototyping with Brush.\n",
    "\n",
    "It also infers the weight of each objective to automatically handle minimization or maximization objetives.\n",
    "\n",
    "To see the weights, you can try:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "13d0ac5f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[-1.0, -1.0]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "est.best_estimator_.fitness.weights"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2fc9fe80",
   "metadata": {},
   "source": [
    "Other information of the best estimator can also be accessed through its fitness attribute:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "de5255e7",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "57\n",
      "29811294\n",
      "8\n"
     ]
    }
   ],
   "source": [
    "print(est.best_estimator_.fitness.size)\n",
    "print(est.best_estimator_.fitness.complexity)\n",
    "print(est.best_estimator_.fitness.depth)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fe594691",
   "metadata": {},
   "source": [
    "## Serialization \n",
    "\n",
    "Brush let's you serialize the entire individual, or just the program or fitness it wraps. It uses JSON to serialize the objects, and this is implemented with the get and set states of an object:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "b01ab1fa",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "fitness {'complexity': 29811294, 'crowding_dist': 3.4028234663852886e+38, 'dcounter': 0, 'depth': 8, 'dominated': [109, 110, 119, 123], 'linear_complexity': 175, 'loss': 2.777221441268921, 'loss_v': 2.777221441268921, 'prev_complexity': 29811294, 'prev_depth': 8, 'prev_linear_complexity': 175, 'prev_loss': 2.777221441268921, 'prev_loss_v': 2.777221441268921, 'prev_size': 57, 'rank': 1, 'size': 57, 'values': [2.777221441268921, 175.0], 'weights': [-1.0, -1.0], 'wvalues': [-2.777221441268921, -175.0]}\n",
      "id 231\n",
      "is_fitted_ False\n",
      "objectives ['mse', 'linear_complexity']\n",
      "parent_id [204]\n",
      "program {'Tree': [{'W': 0.7383487224578857, 'arg_types': ['ArrayF', 'ArrayF'], 'center_op': False, 'feature': '', 'feature_type': 'ArrayF', 'fixed': False, 'is_weighted': False, 'name': 'Add', 'node_type': 'Add', 'prob_change': 1.0, 'ret_type': 'ArrayF', 'sig_dual_hash': 14679000877885575597, 'sig_hash': 14400282083458657357}, {'W': 12.419151306152344, 'arg_types': [], 'center_op': True, 'feature': 'constF', 'feature_type': 'ArrayF', 'fixed': False, 'is_weighted': True, 'name': 'Constant', 'node_type': 'Constant', 'prob_change': 0.6167147755622864, 'ret_type': 'ArrayF', 'sig_dual_hash': 7018942542468397869, 'sig_hash': 14162902253047951597}, {'W': 0.75, 'arg_types': ['ArrayF', 'ArrayF'], 'center_op': False, 'feature': 'x0', 'feature_type': 'ArrayI', 'fixed': False, 'is_weighted': True, 'name': 'SplitBest', 'node_type': 'SplitBest', 'prob_change': 1.0, 'ret_type': 'ArrayF', 'sig_dual_hash': 14679000877885575597, 'sig_hash': 14400282083458657357}, {'W': 0.9919902086257935, 'arg_types': ['ArrayF', 'ArrayF'], 'center_op': False, 'feature': '', 'feature_type': 'ArrayF', 'fixed': False, 'is_weighted': False, 'name': 'Mul', 'node_type': 'Mul', 'prob_change': 1.0, 'ret_type': 'ArrayF', 'sig_dual_hash': 14679000877885575597, 'sig_hash': 14400282083458657357}, {'W': 0.20698793232440948, 'arg_types': ['ArrayF', 'ArrayF'], 'center_op': False, 'feature': '', 'feature_type': 'ArrayF', 'fixed': False, 'is_weighted': False, 'name': 'Add', 'node_type': 'Add', 'prob_change': 1.0, 'ret_type': 'ArrayF', 'sig_dual_hash': 14679000877885575597, 'sig_hash': 14400282083458657357}, {'W': 9.11102294921875, 'arg_types': ['ArrayF'], 'center_op': False, 'feature': '', 'feature_type': 'ArrayF', 'fixed': False, 'is_weighted': True, 'name': 'Cos', 'node_type': 'Cos', 'prob_change': 1.0, 'ret_type': 'ArrayF', 'sig_dual_hash': 13056393536346412951, 'sig_hash': 14128685871577087634}, {'W': 0.9990547299385071, 'arg_types': ['ArrayF', 'ArrayF'], 'center_op': False, 'feature': '', 'feature_type': 'ArrayF', 'fixed': False, 'is_weighted': False, 'name': 'Add', 'node_type': 'Add', 'prob_change': 1.0, 'ret_type': 'ArrayF', 'sig_dual_hash': 14679000877885575597, 'sig_hash': 14400282083458657357}, {'W': 0.8694745898246765, 'arg_types': [], 'center_op': True, 'feature': 'x1', 'feature_type': 'ArrayF', 'fixed': False, 'is_weighted': True, 'name': 'Terminal', 'node_type': 'Terminal', 'prob_change': 0.6729995608329773, 'ret_type': 'ArrayF', 'sig_dual_hash': 7018942542468397869, 'sig_hash': 14162902253047951597}, {'W': 1.0051629543304443, 'arg_types': ['ArrayF', 'ArrayF'], 'center_op': False, 'feature': '', 'feature_type': 'ArrayF', 'fixed': False, 'is_weighted': False, 'name': 'Add', 'node_type': 'Add', 'prob_change': 1.0, 'ret_type': 'ArrayF', 'sig_dual_hash': 14679000877885575597, 'sig_hash': 14400282083458657357}, {'W': -0.6016127467155457, 'arg_types': [], 'center_op': True, 'feature': 'x3', 'feature_type': 'ArrayF', 'fixed': False, 'is_weighted': True, 'name': 'Terminal', 'node_type': 'Terminal', 'prob_change': 0.8625447154045105, 'ret_type': 'ArrayF', 'sig_dual_hash': 7018942542468397869, 'sig_hash': 14162902253047951597}, {'W': 0.17014774680137634, 'arg_types': [], 'center_op': True, 'feature': 'x6', 'feature_type': 'ArrayF', 'fixed': False, 'is_weighted': True, 'name': 'Terminal', 'node_type': 'Terminal', 'prob_change': 0.20750471949577332, 'ret_type': 'ArrayF', 'sig_dual_hash': 7018942542468397869, 'sig_hash': 14162902253047951597}, {'W': 0.3429218530654907, 'arg_types': ['ArrayF', 'ArrayF'], 'center_op': False, 'feature': '', 'feature_type': 'ArrayF', 'fixed': False, 'is_weighted': False, 'name': 'Add', 'node_type': 'Add', 'prob_change': 1.0, 'ret_type': 'ArrayF', 'sig_dual_hash': 14679000877885575597, 'sig_hash': 14400282083458657357}, {'W': 24.257442474365234, 'arg_types': [], 'center_op': True, 'feature': 'x6', 'feature_type': 'ArrayF', 'fixed': False, 'is_weighted': True, 'name': 'Terminal', 'node_type': 'Terminal', 'prob_change': 0.20750471949577332, 'ret_type': 'ArrayF', 'sig_dual_hash': 7018942542468397869, 'sig_hash': 14162902253047951597}, {'W': 13.50589656829834, 'arg_types': [], 'center_op': True, 'feature': 'constF', 'feature_type': 'ArrayF', 'fixed': False, 'is_weighted': True, 'name': 'Constant', 'node_type': 'Constant', 'prob_change': 0.6167147755622864, 'ret_type': 'ArrayF', 'sig_dual_hash': 7018942542468397869, 'sig_hash': 14162902253047951597}, {'W': 0.8166581988334656, 'arg_types': ['ArrayF', 'ArrayF'], 'center_op': False, 'feature': '', 'feature_type': 'ArrayF', 'fixed': False, 'is_weighted': True, 'name': 'Add', 'node_type': 'Add', 'prob_change': 1.0, 'ret_type': 'ArrayF', 'sig_dual_hash': 14679000877885575597, 'sig_hash': 14400282083458657357}, {'W': 1.4599151611328125, 'arg_types': ['ArrayF'], 'center_op': False, 'feature': '', 'feature_type': 'ArrayF', 'fixed': False, 'is_weighted': True, 'name': 'Exp', 'node_type': 'Exp', 'prob_change': 1.0, 'ret_type': 'ArrayF', 'sig_dual_hash': 13056393536346412951, 'sig_hash': 14128685871577087634}, {'W': 0.10822294652462006, 'arg_types': ['ArrayF'], 'center_op': False, 'feature': '', 'feature_type': 'ArrayF', 'fixed': False, 'is_weighted': True, 'name': 'Sin', 'node_type': 'Sin', 'prob_change': 1.0, 'ret_type': 'ArrayF', 'sig_dual_hash': 13056393536346412951, 'sig_hash': 14128685871577087634}, {'W': 219.50527954101562, 'arg_types': [], 'center_op': True, 'feature': 'x0', 'feature_type': 'ArrayF', 'fixed': False, 'is_weighted': True, 'name': 'Terminal', 'node_type': 'Terminal', 'prob_change': 0.6343384981155396, 'ret_type': 'ArrayF', 'sig_dual_hash': 7018942542468397869, 'sig_hash': 14162902253047951597}, {'W': -0.4879826009273529, 'arg_types': [], 'center_op': True, 'feature': 'x6', 'feature_type': 'ArrayF', 'fixed': False, 'is_weighted': True, 'name': 'Terminal', 'node_type': 'Terminal', 'prob_change': 0.20750471949577332, 'ret_type': 'ArrayF', 'sig_dual_hash': 7018942542468397869, 'sig_hash': 14162902253047951597}, {'W': 0.7472416162490845, 'arg_types': ['ArrayF', 'ArrayF'], 'center_op': False, 'feature': '', 'feature_type': 'ArrayF', 'fixed': False, 'is_weighted': False, 'name': 'Add', 'node_type': 'Add', 'prob_change': 1.0, 'ret_type': 'ArrayF', 'sig_dual_hash': 14679000877885575597, 'sig_hash': 14400282083458657357}, {'W': 0.7639648914337158, 'arg_types': ['ArrayF'], 'center_op': False, 'feature': '', 'feature_type': 'ArrayF', 'fixed': False, 'is_weighted': True, 'name': 'Exp', 'node_type': 'Exp', 'prob_change': 1.0, 'ret_type': 'ArrayF', 'sig_dual_hash': 13056393536346412951, 'sig_hash': 14128685871577087634}, {'W': 1.941291093826294, 'arg_types': ['ArrayF'], 'center_op': False, 'feature': '', 'feature_type': 'ArrayF', 'fixed': False, 'is_weighted': True, 'name': 'Sin', 'node_type': 'Sin', 'prob_change': 1.0, 'ret_type': 'ArrayF', 'sig_dual_hash': 13056393536346412951, 'sig_hash': 14128685871577087634}, {'W': 218.45458984375, 'arg_types': [], 'center_op': True, 'feature': 'x0', 'feature_type': 'ArrayF', 'fixed': False, 'is_weighted': True, 'name': 'Terminal', 'node_type': 'Terminal', 'prob_change': 0.6343384981155396, 'ret_type': 'ArrayF', 'sig_dual_hash': 7018942542468397869, 'sig_hash': 14162902253047951597}, {'W': 10.577406883239746, 'arg_types': [], 'center_op': True, 'feature': 'x6', 'feature_type': 'ArrayF', 'fixed': False, 'is_weighted': True, 'name': 'Terminal', 'node_type': 'Terminal', 'prob_change': 0.20750471949577332, 'ret_type': 'ArrayF', 'sig_dual_hash': 7018942542468397869, 'sig_hash': 14162902253047951597}], 'is_fitted_': True}\n",
      "variation toggle_weight_on\n"
     ]
    }
   ],
   "source": [
    "estimator_dict = est.best_estimator_.__getstate__()\n",
    "\n",
    "for k, v in estimator_dict.items():\n",
    "    print(k, v)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6bcb071b",
   "metadata": {},
   "source": [
    "With serialization, you can use pickle to save and load just programs or even the entire individual."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "b4537631",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pickle\n",
    "import os, tempfile\n",
    "\n",
    "individual_file = os.path.join(tempfile.mkdtemp(), 'individual.json')\n",
    "with open(individual_file, \"wb\") as f:\n",
    "    pickle.dump(est.best_estimator_, f)\n",
    "\n",
    "program_file = os.path.join(tempfile.mkdtemp(), 'program.json')\n",
    "with open(program_file, \"wb\") as f:\n",
    "    pickle.dump(est.best_estimator_.program, f)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fff5693d",
   "metadata": {},
   "source": [
    "Then we can load it later with:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "ee7a20c6",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Add(12.42,If(x0>0.75,Mul(Add(9.11*Cos(Add(0.87*x1,Add(-0.60*x3,0.17*x6))),Add(24.26*x6,13.51)),0.82*Add(1.46*Exp(0.11*Sin(219.51*x0)),-0.49*x6)),Add(0.76*Exp(1.94*Sin(218.45*x0)),10.58*x6)))\n"
     ]
    }
   ],
   "source": [
    "with open(individual_file, \"rb\") as f:\n",
    "    loaded_estimator = pickle.load(f)\n",
    "    print(loaded_estimator.get_model())"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a355d8f3",
   "metadata": {},
   "source": [
    "### String\n",
    "\n",
    "Now that we have trained a model, `est.best_estimator_` contains our symbolic model. \n",
    "We can view it as a string:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "316964d5",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Add(12.42,If(x0>0.75,Mul(Add(9.11*Cos(Add(0.87*x1,Add(-0.60*x3,0.17*x6))),Add(24.26*x6,13.51)),0.82*Add(1.46*Exp(0.11*Sin(219.51*x0)),-0.49*x6)),Add(0.76*Exp(1.94*Sin(218.45*x0)),10.58*x6)))\n"
     ]
    }
   ],
   "source": [
    "print(est.best_estimator_.get_model())"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e7d578bb",
   "metadata": {},
   "source": [
    "### Quick Little Tree\n",
    "\n",
    "Or, we can view it as a compact tree:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "dad68d01",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Add\n",
      "|- 12.42\n",
      "|- If(x0>0.75)\n",
      "|  |- Mul\n",
      "|  |  |- Add\n",
      "|  |  |  |- 9.11*Cos\n",
      "|  |  |  |  |- Add\n",
      "|  |  |  |  |  |- 0.87*x1\n",
      "|  |  |  |  |  |- Add\n",
      "|  |  |  |  |  |  |- -0.60*x3\n",
      "|  |  |  |  |  |  |- 0.17*x6\n",
      "|  |  |  |- Add\n",
      "|  |  |  |  |- 24.26*x6\n",
      "|  |  |  |  |- 13.51\n",
      "|  |  |- 0.82*Add\n",
      "|  |  |  |- 1.46*Exp\n",
      "|  |  |  |  |- 0.11*Sin\n",
      "|  |  |  |  |  |- 219.51*x0\n",
      "|  |  |  |- -0.49*x6\n",
      "|  |- Add\n",
      "|  |  |- 0.76*Exp\n",
      "|  |  |  |- 1.94*Sin\n",
      "|  |  |  |  |- 218.45*x0\n",
      "|  |  |- 10.58*x6\n"
     ]
    }
   ],
   "source": [
    "print(est.best_estimator_.get_model(\"tree\"))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "90068143",
   "metadata": {},
   "source": [
    "### GraphViz\n",
    "\n",
    "If we are feeling fancy ðŸŽ©, we can also view it as a graph in dot format. \n",
    "Let's import graphviz and make a nicer plot."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "3ef1a735",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 12.0.0 (0)\n",
       " -->\n",
       "<!-- Title: G Pages: 1 -->\n",
       "<svg width=\"431pt\" height=\"633pt\"\n",
       " viewBox=\"0.00 0.00 431.37 632.50\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 628.5)\">\n",
       "<title>G</title>\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-628.5 427.37,-628.5 427.37,4 -4,4\"/>\n",
       "<!-- 15081d5e0 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>15081d5e0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"190.62\" cy=\"-606.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"190.62\" y=\"-601.45\" font-family=\"Times,serif\" font-size=\"14.00\">Add</text>\n",
       "</g>\n",
       "<!-- 1510298a0 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>1510298a0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"178.62\" cy=\"-533.5\" rx=\"31.9\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"178.62\" y=\"-528.45\" font-family=\"Times,serif\" font-size=\"14.00\">12.42</text>\n",
       "</g>\n",
       "<!-- 15081d5e0&#45;&gt;1510298a0 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>15081d5e0&#45;&gt;1510298a0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M187.72,-588.31C186.42,-580.64 184.86,-571.39 183.39,-562.74\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"186.87,-562.3 181.75,-553.02 179.97,-563.46 186.87,-562.3\"/>\n",
       "</g>\n",
       "<!-- 1508d3250 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>1508d3250</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"274.62\" cy=\"-533.5\" rx=\"46.23\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"274.62\" y=\"-528.45\" font-family=\"Times,serif\" font-size=\"14.00\">x0&gt;0.75?</text>\n",
       "</g>\n",
       "<!-- 15081d5e0&#45;&gt;1508d3250 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>15081d5e0&#45;&gt;1508d3250</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M206.82,-591.81C218.21,-582.18 233.73,-569.07 247.04,-557.81\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"249.3,-560.48 254.68,-551.36 244.78,-555.14 249.3,-560.48\"/>\n",
       "</g>\n",
       "<!-- 146de38e0 -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>146de38e0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"231.62\" cy=\"-460.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"231.62\" y=\"-455.45\" font-family=\"Times,serif\" font-size=\"14.00\">Mul</text>\n",
       "</g>\n",
       "<!-- 1508d3250&#45;&gt;146de38e0 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>1508d3250&#45;&gt;146de38e0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M264.43,-515.67C259.32,-507.24 253.03,-496.84 247.32,-487.42\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"250.4,-485.75 242.23,-479.01 244.41,-489.38 250.4,-485.75\"/>\n",
       "<text text-anchor=\"middle\" x=\"259.56\" y=\"-502.37\" font-family=\"Times,serif\" font-size=\"14.00\">Y</text>\n",
       "</g>\n",
       "<!-- 1507536d0 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>1507536d0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"329.62\" cy=\"-372\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"329.62\" y=\"-366.95\" font-family=\"Times,serif\" font-size=\"14.00\">Add</text>\n",
       "</g>\n",
       "<!-- 1508d3250&#45;&gt;1507536d0 -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>1508d3250&#45;&gt;1507536d0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M280.51,-515.43C289.98,-487.97 308.68,-433.72 320.08,-400.67\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"323.33,-401.97 323.28,-391.38 316.72,-399.69 323.33,-401.97\"/>\n",
       "<text text-anchor=\"middle\" x=\"275.63\" y=\"-502.13\" font-family=\"Times,serif\" font-size=\"14.00\">N</text>\n",
       "</g>\n",
       "<!-- 146ded660 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>146ded660</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"120.62\" cy=\"-372\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"120.62\" y=\"-366.95\" font-family=\"Times,serif\" font-size=\"14.00\">Add</text>\n",
       "</g>\n",
       "<!-- 146de38e0&#45;&gt;146ded660 -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>146de38e0&#45;&gt;146ded660</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M214.76,-446.36C196.67,-432.26 167.7,-409.69 146.67,-393.3\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"148.87,-390.58 138.83,-387.19 144.57,-396.1 148.87,-390.58\"/>\n",
       "</g>\n",
       "<!-- 150766fa0 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>150766fa0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"231.62\" cy=\"-372\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"231.62\" y=\"-366.95\" font-family=\"Times,serif\" font-size=\"14.00\">Add</text>\n",
       "</g>\n",
       "<!-- 146de38e0&#45;&gt;150766fa0 -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>146de38e0&#45;&gt;150766fa0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M231.62,-442.41C231.62,-430.76 231.62,-415.05 231.62,-401.52\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"235.12,-401.86 231.62,-391.86 228.12,-401.86 235.12,-401.86\"/>\n",
       "<text text-anchor=\"middle\" x=\"243.62\" y=\"-411.2\" font-family=\"Times,serif\" font-size=\"14.00\">0.82</text>\n",
       "</g>\n",
       "<!-- x6 -->\n",
       "<g id=\"node14\" class=\"node\">\n",
       "<title>x6</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"173.62\" cy=\"-18\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"173.62\" y=\"-12.95\" font-family=\"Times,serif\" font-size=\"14.00\">x6</text>\n",
       "</g>\n",
       "<!-- 1507536d0&#45;&gt;x6 -->\n",
       "<g id=\"edge21\" class=\"edge\">\n",
       "<title>1507536d0&#45;&gt;x6</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M347.17,-358.15C365.81,-342.88 392.62,-315.53 392.62,-284.5 392.62,-284.5 392.62,-284.5 392.62,-105.5 392.62,-66.82 272.97,-38.06 210.55,-25.69\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"211.57,-22.32 201.09,-23.86 210.24,-29.2 211.57,-22.32\"/>\n",
       "<text text-anchor=\"middle\" x=\"408\" y=\"-189.95\" font-family=\"Times,serif\" font-size=\"14.00\">10.58</text>\n",
       "</g>\n",
       "<!-- 150771ef0 -->\n",
       "<g id=\"node19\" class=\"node\">\n",
       "<title>150771ef0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"329.62\" cy=\"-283.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"329.62\" y=\"-278.45\" font-family=\"Times,serif\" font-size=\"14.00\">Exp</text>\n",
       "</g>\n",
       "<!-- 1507536d0&#45;&gt;150771ef0 -->\n",
       "<g id=\"edge20\" class=\"edge\">\n",
       "<title>1507536d0&#45;&gt;150771ef0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M329.62,-353.91C329.62,-342.26 329.62,-326.55 329.62,-313.02\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"333.12,-313.36 329.62,-303.36 326.12,-313.36 333.12,-313.36\"/>\n",
       "<text text-anchor=\"middle\" x=\"341.62\" y=\"-322.7\" font-family=\"Times,serif\" font-size=\"14.00\">0.76</text>\n",
       "</g>\n",
       "<!-- 146d919c0 -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>146d919c0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"120.62\" cy=\"-283.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"120.62\" y=\"-278.45\" font-family=\"Times,serif\" font-size=\"14.00\">Cos</text>\n",
       "</g>\n",
       "<!-- 146ded660&#45;&gt;146d919c0 -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>146ded660&#45;&gt;146d919c0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M120.62,-353.91C120.62,-342.26 120.62,-326.55 120.62,-313.02\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"124.12,-313.36 120.62,-303.36 117.12,-313.36 124.12,-313.36\"/>\n",
       "<text text-anchor=\"middle\" x=\"132.62\" y=\"-322.7\" font-family=\"Times,serif\" font-size=\"14.00\">9.11</text>\n",
       "</g>\n",
       "<!-- 1507a7200 -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>1507a7200</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"43.62\" cy=\"-283.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"43.62\" y=\"-278.45\" font-family=\"Times,serif\" font-size=\"14.00\">Add</text>\n",
       "</g>\n",
       "<!-- 146ded660&#45;&gt;1507a7200 -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>146ded660&#45;&gt;1507a7200</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M107.21,-355.93C95.39,-342.66 78,-323.12 64.39,-307.83\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"67.15,-305.67 57.89,-300.53 61.92,-310.32 67.15,-305.67\"/>\n",
       "</g>\n",
       "<!-- 150766fa0&#45;&gt;x6 -->\n",
       "<g id=\"edge17\" class=\"edge\">\n",
       "<title>150766fa0&#45;&gt;x6</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M217.48,-356.43C203.32,-340.24 183.62,-312.67 183.62,-284.5 183.62,-284.5 183.62,-284.5 183.62,-105.5 183.62,-86.04 181.09,-64.27 178.58,-47.44\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"182.05,-46.99 177.02,-37.66 175.14,-48.09 182.05,-46.99\"/>\n",
       "<text text-anchor=\"middle\" x=\"197.87\" y=\"-189.95\" font-family=\"Times,serif\" font-size=\"14.00\">&#45;0.49</text>\n",
       "</g>\n",
       "<!-- 15073dc40 -->\n",
       "<g id=\"node16\" class=\"node\">\n",
       "<title>15073dc40</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"251.62\" cy=\"-283.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"251.62\" y=\"-278.45\" font-family=\"Times,serif\" font-size=\"14.00\">Exp</text>\n",
       "</g>\n",
       "<!-- 150766fa0&#45;&gt;15073dc40 -->\n",
       "<g id=\"edge16\" class=\"edge\">\n",
       "<title>150766fa0&#45;&gt;15073dc40</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M235.57,-353.91C238.28,-342.18 241.95,-326.34 245.09,-312.75\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"248.49,-313.56 247.34,-303.03 241.67,-311.98 248.49,-313.56\"/>\n",
       "<text text-anchor=\"middle\" x=\"254.62\" y=\"-322.7\" font-family=\"Times,serif\" font-size=\"14.00\">1.46</text>\n",
       "</g>\n",
       "<!-- 146d40a70 -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>146d40a70</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"120.62\" cy=\"-195\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"120.62\" y=\"-189.95\" font-family=\"Times,serif\" font-size=\"14.00\">Add</text>\n",
       "</g>\n",
       "<!-- 146d919c0&#45;&gt;146d40a70 -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>146d919c0&#45;&gt;146d40a70</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M120.62,-265.41C120.62,-253.76 120.62,-238.05 120.62,-224.52\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"124.12,-224.86 120.62,-214.86 117.12,-224.86 124.12,-224.86\"/>\n",
       "</g>\n",
       "<!-- 1507a7200&#45;&gt;x6 -->\n",
       "<g id=\"edge14\" class=\"edge\">\n",
       "<title>1507a7200&#45;&gt;x6</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M31.2,-267.05C21.28,-253.65 8.15,-233.27 2.62,-213 -6.46,-179.73 15.18,-90.47 16.62,-88.5 24.39,-77.89 96.11,-48.86 139.88,-31.86\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"140.87,-35.23 148.94,-28.36 138.35,-28.7 140.87,-35.23\"/>\n",
       "<text text-anchor=\"middle\" x=\"21\" y=\"-145.7\" font-family=\"Times,serif\" font-size=\"14.00\">24.26</text>\n",
       "</g>\n",
       "<!-- 1507093c0 -->\n",
       "<g id=\"node15\" class=\"node\">\n",
       "<title>1507093c0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"43.62\" cy=\"-195\" rx=\"31.9\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"43.62\" y=\"-189.95\" font-family=\"Times,serif\" font-size=\"14.00\">13.51</text>\n",
       "</g>\n",
       "<!-- 1507a7200&#45;&gt;1507093c0 -->\n",
       "<g id=\"edge15\" class=\"edge\">\n",
       "<title>1507a7200&#45;&gt;1507093c0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M43.62,-265.41C43.62,-253.76 43.62,-238.05 43.62,-224.52\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"47.12,-224.86 43.62,-214.86 40.12,-224.86 47.12,-224.86\"/>\n",
       "</g>\n",
       "<!-- x1 -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>x1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"52.62\" cy=\"-106.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"52.62\" y=\"-101.45\" font-family=\"Times,serif\" font-size=\"14.00\">x1</text>\n",
       "</g>\n",
       "<!-- 146d40a70&#45;&gt;x1 -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>146d40a70&#45;&gt;x1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M108.46,-178.54C98.21,-165.5 83.37,-146.62 71.56,-131.6\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"74.54,-129.72 65.61,-124.02 69.04,-134.05 74.54,-129.72\"/>\n",
       "<text text-anchor=\"middle\" x=\"104.62\" y=\"-145.7\" font-family=\"Times,serif\" font-size=\"14.00\">0.87</text>\n",
       "</g>\n",
       "<!-- 1507cd020 -->\n",
       "<g id=\"node12\" class=\"node\">\n",
       "<title>1507cd020</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"124.62\" cy=\"-106.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"124.62\" y=\"-101.45\" font-family=\"Times,serif\" font-size=\"14.00\">Add</text>\n",
       "</g>\n",
       "<!-- 146d40a70&#45;&gt;1507cd020 -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>146d40a70&#45;&gt;1507cd020</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M121.41,-176.91C121.95,-165.26 122.68,-149.55 123.3,-136.02\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"126.78,-136.51 123.75,-126.36 119.79,-136.19 126.78,-136.51\"/>\n",
       "</g>\n",
       "<!-- x3 -->\n",
       "<g id=\"node13\" class=\"node\">\n",
       "<title>x3</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"92.62\" cy=\"-18\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"92.62\" y=\"-12.95\" font-family=\"Times,serif\" font-size=\"14.00\">x3</text>\n",
       "</g>\n",
       "<!-- 1507cd020&#45;&gt;x3 -->\n",
       "<g id=\"edge12\" class=\"edge\">\n",
       "<title>1507cd020&#45;&gt;x3</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M108.68,-91.73C103,-85.82 97.23,-78.46 94.12,-70.5 91.34,-63.39 90.25,-55.3 90.02,-47.68\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"93.52,-47.86 90.24,-37.79 86.52,-47.71 93.52,-47.86\"/>\n",
       "<text text-anchor=\"middle\" x=\"107.87\" y=\"-57.2\" font-family=\"Times,serif\" font-size=\"14.00\">&#45;0.60</text>\n",
       "</g>\n",
       "<!-- 1507cd020&#45;&gt;x6 -->\n",
       "<g id=\"edge13\" class=\"edge\">\n",
       "<title>1507cd020&#45;&gt;x6</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M130.09,-88.69C133.79,-78.34 139.17,-64.99 145.62,-54 147.8,-50.29 150.34,-46.56 152.99,-42.97\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"155.69,-45.2 159.13,-35.17 150.19,-40.87 155.69,-45.2\"/>\n",
       "<text text-anchor=\"middle\" x=\"157.62\" y=\"-57.2\" font-family=\"Times,serif\" font-size=\"14.00\">0.17</text>\n",
       "</g>\n",
       "<!-- 1507d5ba0 -->\n",
       "<g id=\"node17\" class=\"node\">\n",
       "<title>1507d5ba0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"257.62\" cy=\"-195\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"257.62\" y=\"-189.95\" font-family=\"Times,serif\" font-size=\"14.00\">Sin</text>\n",
       "</g>\n",
       "<!-- 15073dc40&#45;&gt;1507d5ba0 -->\n",
       "<g id=\"edge18\" class=\"edge\">\n",
       "<title>15073dc40&#45;&gt;1507d5ba0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M252.81,-265.41C253.61,-253.76 254.7,-238.05 255.64,-224.52\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"259.11,-225.08 256.31,-214.86 252.13,-224.59 259.11,-225.08\"/>\n",
       "<text text-anchor=\"middle\" x=\"266.62\" y=\"-234.2\" font-family=\"Times,serif\" font-size=\"14.00\">0.11</text>\n",
       "</g>\n",
       "<!-- x0 -->\n",
       "<g id=\"node18\" class=\"node\">\n",
       "<title>x0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"291.62\" cy=\"-106.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"291.62\" y=\"-101.45\" font-family=\"Times,serif\" font-size=\"14.00\">x0</text>\n",
       "</g>\n",
       "<!-- 1507d5ba0&#45;&gt;x0 -->\n",
       "<g id=\"edge19\" class=\"edge\">\n",
       "<title>1507d5ba0&#45;&gt;x0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M257.99,-176.73C258.72,-166.45 260.59,-153.34 265.12,-142.5 266.75,-138.62 268.9,-134.78 271.29,-131.15\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"273.92,-133.48 277.03,-123.35 268.28,-129.33 273.92,-133.48\"/>\n",
       "<text text-anchor=\"middle\" x=\"283.37\" y=\"-145.7\" font-family=\"Times,serif\" font-size=\"14.00\">219.51</text>\n",
       "</g>\n",
       "<!-- 150175c60 -->\n",
       "<g id=\"node20\" class=\"node\">\n",
       "<title>150175c60</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"329.62\" cy=\"-195\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"329.62\" y=\"-189.95\" font-family=\"Times,serif\" font-size=\"14.00\">Sin</text>\n",
       "</g>\n",
       "<!-- 150771ef0&#45;&gt;150175c60 -->\n",
       "<g id=\"edge22\" class=\"edge\">\n",
       "<title>150771ef0&#45;&gt;150175c60</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M329.62,-265.41C329.62,-253.76 329.62,-238.05 329.62,-224.52\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"333.12,-224.86 329.62,-214.86 326.12,-224.86 333.12,-224.86\"/>\n",
       "<text text-anchor=\"middle\" x=\"341.62\" y=\"-234.2\" font-family=\"Times,serif\" font-size=\"14.00\">1.94</text>\n",
       "</g>\n",
       "<!-- 150175c60&#45;&gt;x0 -->\n",
       "<g id=\"edge23\" class=\"edge\">\n",
       "<title>150175c60&#45;&gt;x0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M322.29,-177.32C316.98,-165.24 309.69,-148.63 303.55,-134.64\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"306.76,-133.26 299.53,-125.51 300.35,-136.08 306.76,-133.26\"/>\n",
       "<text text-anchor=\"middle\" x=\"332.37\" y=\"-145.7\" font-family=\"Times,serif\" font-size=\"14.00\">218.45</text>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.sources.Source at 0x14627b4d0>"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import graphviz\n",
    "\n",
    "model = est.best_estimator_.get_model(\"dot\")\n",
    "graphviz.Source(model)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a2f93509",
   "metadata": {},
   "source": [
    "The `model` variable is now a little program in the [dot language](https://graphviz.org/docs/layouts/dot/), which we can inspect directly. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "1f7e725e",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "digraph G {\n",
      "\"15081d5e0\" [label=\"Add\"];\n",
      "\"15081d5e0\" -> \"1510298a0\" [label=\"\"];\n",
      "\"15081d5e0\" -> \"1508d3250\" [label=\"\"];\n",
      "\"1510298a0\" [label=\"12.42\"];\n",
      "\"1508d3250\" [label=\"x0>0.75?\"];\n",
      "\"1508d3250\" -> \"146de38e0\" [headlabel=\"\",taillabel=\"Y\"];\n",
      "\"1508d3250\" -> \"1507536d0\" [headlabel=\"\",taillabel=\"N\"];\n",
      "\"146de38e0\" [label=\"Mul\"];\n",
      "\"146de38e0\" -> \"146ded660\" [label=\"\"];\n",
      "\"146de38e0\" -> \"150766fa0\" [label=\"0.82\"];\n",
      "\"146ded660\" [label=\"Add\"];\n",
      "\"146ded660\" -> \"146d919c0\" [label=\"9.11\"];\n",
      "\"146ded660\" -> \"1507a7200\" [label=\"\"];\n",
      "\"146d919c0\" [label=\"Cos\"];\n",
      "\"146d919c0\" -> \"146d40a70\" [label=\"\"];\n",
      "\"146d40a70\" [label=\"Add\"];\n",
      "\"146d40a70\" -> \"x1\" [label=\"0.87\"];\n",
      "\"146d40a70\" -> \"1507cd020\" [label=\"\"];\n",
      "\"x1\" [label=\"x1\"];\n",
      "\"1507cd020\" [label=\"Add\"];\n",
      "\"1507cd020\" -> \"x3\" [label=\"-0.60\"];\n",
      "\"1507cd020\" -> \"x6\" [label=\"0.17\"];\n",
      "\"x3\" [label=\"x3\"];\n",
      "\"x6\" [label=\"x6\"];\n",
      "\"1507a7200\" [label=\"Add\"];\n",
      "\"1507a7200\" -> \"x6\" [label=\"24.26\"];\n",
      "\"1507a7200\" -> \"1507093c0\" [label=\"\"];\n",
      "\"x6\" [label=\"x6\"];\n",
      "\"1507093c0\" [label=\"13.51\"];\n",
      "\"150766fa0\" [label=\"Add\"];\n",
      "\"150766fa0\" -> \"15073dc40\" [label=\"1.46\"];\n",
      "\"150766fa0\" -> \"x6\" [label=\"-0.49\"];\n",
      "\"15073dc40\" [label=\"Exp\"];\n",
      "\"15073dc40\" -> \"1507d5ba0\" [label=\"0.11\"];\n",
      "\"1507d5ba0\" [label=\"Sin\"];\n",
      "\"1507d5ba0\" -> \"x0\" [label=\"219.51\"];\n",
      "\"x0\" [label=\"x0\"];\n",
      "\"x6\" [label=\"x6\"];\n",
      "\"1507536d0\" [label=\"Add\"];\n",
      "\"1507536d0\" -> \"150771ef0\" [label=\"0.76\"];\n",
      "\"1507536d0\" -> \"x6\" [label=\"10.58\"];\n",
      "\"150771ef0\" [label=\"Exp\"];\n",
      "\"150771ef0\" -> \"150175c60\" [label=\"1.94\"];\n",
      "\"150175c60\" [label=\"Sin\"];\n",
      "\"150175c60\" -> \"x0\" [label=\"218.45\"];\n",
      "\"x0\" [label=\"x0\"];\n",
      "\"x6\" [label=\"x6\"];\n",
      "}\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(model)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b9c0154a",
   "metadata": {},
   "source": [
    "### Tweaking Graphs\n",
    "\n",
    "The [dot manual](https://graphviz.org/docs/layouts/dot/) has lots of options for tweaking the graphs. \n",
    "You can do this by manually editing `model`, but brush also provides a function, `get_dot_model()`, to which you can pass additional arguments to dot. \n",
    "\n",
    "For example, let's view the graph from Left-to-Right: "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "f35b1e05",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 12.0.0 (0)\n",
       " -->\n",
       "<!-- Title: G Pages: 1 -->\n",
       "<svg width=\"880pt\" height=\"386pt\"\n",
       " viewBox=\"0.00 0.00 880.27 386.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 382)\">\n",
       "<title>G</title>\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-382 876.27,-382 876.27,4 -4,4\"/>\n",
       "<!-- 15081d5e0 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>15081d5e0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"27\" cy=\"-112\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"27\" y=\"-106.95\" font-family=\"Times,serif\" font-size=\"14.00\">Add</text>\n",
       "</g>\n",
       "<!-- 1510298a0 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>1510298a0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"137.23\" cy=\"-139\" rx=\"31.9\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"137.23\" y=\"-133.95\" font-family=\"Times,serif\" font-size=\"14.00\">12.42</text>\n",
       "</g>\n",
       "<!-- 15081d5e0&#45;&gt;1510298a0 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>15081d5e0&#45;&gt;1510298a0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M52.83,-118.19C65.86,-121.44 82.13,-125.5 96.84,-129.17\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"95.68,-132.49 106.22,-131.51 97.37,-125.7 95.68,-132.49\"/>\n",
       "</g>\n",
       "<!-- 1508d3250 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>1508d3250</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"137.23\" cy=\"-85\" rx=\"46.23\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"137.23\" y=\"-79.95\" font-family=\"Times,serif\" font-size=\"14.00\">x0&gt;0.75?</text>\n",
       "</g>\n",
       "<!-- 15081d5e0&#45;&gt;1508d3250 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>15081d5e0&#45;&gt;1508d3250</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M52.83,-105.81C62.86,-103.3 74.8,-100.32 86.48,-97.41\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"87.19,-100.84 96.05,-95.03 85.5,-94.05 87.19,-100.84\"/>\n",
       "</g>\n",
       "<!-- 146de38e0 -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>146de38e0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"247.47\" cy=\"-149\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"247.47\" y=\"-143.95\" font-family=\"Times,serif\" font-size=\"14.00\">Mul</text>\n",
       "</g>\n",
       "<!-- 1508d3250&#45;&gt;146de38e0 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>1508d3250&#45;&gt;146de38e0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M163.88,-100.17C179.72,-109.53 200.11,-121.59 216.67,-131.38\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"214.72,-134.29 225.11,-136.37 218.28,-128.27 214.72,-134.29\"/>\n",
       "<text text-anchor=\"middle\" x=\"159.01\" y=\"-103.37\" font-family=\"Times,serif\" font-size=\"14.00\">Y</text>\n",
       "</g>\n",
       "<!-- 1507536d0 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>1507536d0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"361.47\" cy=\"-53\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"361.47\" y=\"-47.95\" font-family=\"Times,serif\" font-size=\"14.00\">Add</text>\n",
       "</g>\n",
       "<!-- 1508d3250&#45;&gt;1507536d0 -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>1508d3250&#45;&gt;1507536d0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M181.08,-78.83C222.44,-72.88 284.38,-63.96 323.59,-58.31\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"323.85,-61.81 333.24,-56.92 322.85,-54.88 323.85,-61.81\"/>\n",
       "<text text-anchor=\"middle\" x=\"185.96\" y=\"-65.53\" font-family=\"Times,serif\" font-size=\"14.00\">N</text>\n",
       "</g>\n",
       "<!-- 146ded660 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>146ded660</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"361.47\" cy=\"-218\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"361.47\" y=\"-212.95\" font-family=\"Times,serif\" font-size=\"14.00\">Add</text>\n",
       "</g>\n",
       "<!-- 146de38e0&#45;&gt;146ded660 -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>146de38e0&#45;&gt;146ded660</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M267.98,-161.02C285.45,-171.79 311.33,-187.73 331.28,-200.02\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"329.17,-202.83 339.52,-205.09 332.84,-196.87 329.17,-202.83\"/>\n",
       "</g>\n",
       "<!-- 150766fa0 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>150766fa0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"361.47\" cy=\"-149\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"361.47\" y=\"-143.95\" font-family=\"Times,serif\" font-size=\"14.00\">Add</text>\n",
       "</g>\n",
       "<!-- 146de38e0&#45;&gt;150766fa0 -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>146de38e0&#45;&gt;150766fa0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M274.73,-149C288.95,-149 306.77,-149 322.48,-149\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"322.47,-152.5 332.47,-149 322.47,-145.5 322.47,-152.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"304.47\" y=\"-152.2\" font-family=\"Times,serif\" font-size=\"14.00\">0.82</text>\n",
       "</g>\n",
       "<!-- x6 -->\n",
       "<g id=\"node14\" class=\"node\">\n",
       "<title>x6</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"845.27\" cy=\"-211\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"845.27\" y=\"-205.95\" font-family=\"Times,serif\" font-size=\"14.00\">x6</text>\n",
       "</g>\n",
       "<!-- 1507536d0&#45;&gt;x6 -->\n",
       "<g id=\"edge21\" class=\"edge\">\n",
       "<title>1507536d0&#45;&gt;x6</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M379.51,-39.07C400.51,-23.37 437.9,0 474.47,0 474.47,0 474.47,0 727.77,0 809.62,0 834.4,-123.16 841.54,-181.29\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"838.06,-181.59 842.65,-191.14 845.01,-180.81 838.06,-181.59\"/>\n",
       "<text text-anchor=\"middle\" x=\"594.37\" y=\"-3.2\" font-family=\"Times,serif\" font-size=\"14.00\">10.58</text>\n",
       "</g>\n",
       "<!-- 150771ef0 -->\n",
       "<g id=\"node19\" class=\"node\">\n",
       "<title>150771ef0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"475.47\" cy=\"-53\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"475.47\" y=\"-47.95\" font-family=\"Times,serif\" font-size=\"14.00\">Exp</text>\n",
       "</g>\n",
       "<!-- 1507536d0&#45;&gt;150771ef0 -->\n",
       "<g id=\"edge20\" class=\"edge\">\n",
       "<title>1507536d0&#45;&gt;150771ef0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M388.73,-53C402.95,-53 420.77,-53 436.48,-53\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"436.47,-56.5 446.47,-53 436.47,-49.5 436.47,-56.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"418.47\" y=\"-56.2\" font-family=\"Times,serif\" font-size=\"14.00\">0.76</text>\n",
       "</g>\n",
       "<!-- 146d919c0 -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>146d919c0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"475.47\" cy=\"-280\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"475.47\" y=\"-274.95\" font-family=\"Times,serif\" font-size=\"14.00\">Cos</text>\n",
       "</g>\n",
       "<!-- 146ded660&#45;&gt;146d919c0 -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>146ded660&#45;&gt;146d919c0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M383.01,-229.37C400.14,-238.85 424.79,-252.5 444.18,-263.23\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"442.29,-266.19 452.73,-267.97 445.68,-260.06 442.29,-266.19\"/>\n",
       "<text text-anchor=\"middle\" x=\"418.47\" y=\"-257.2\" font-family=\"Times,serif\" font-size=\"14.00\">9.11</text>\n",
       "</g>\n",
       "<!-- 1507a7200 -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>1507a7200</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"475.47\" cy=\"-218\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"475.47\" y=\"-212.95\" font-family=\"Times,serif\" font-size=\"14.00\">Add</text>\n",
       "</g>\n",
       "<!-- 146ded660&#45;&gt;1507a7200 -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>146ded660&#45;&gt;1507a7200</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M388.73,-218C402.95,-218 420.77,-218 436.48,-218\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"436.47,-221.5 446.47,-218 436.47,-214.5 436.47,-221.5\"/>\n",
       "</g>\n",
       "<!-- 150766fa0&#45;&gt;x6 -->\n",
       "<g id=\"edge17\" class=\"edge\">\n",
       "<title>150766fa0&#45;&gt;x6</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M388.18,-153.33C410.83,-156.77 444.74,-161 474.47,-161 474.47,-161 474.47,-161 727.77,-161 760.22,-161 793.93,-177.58 816.69,-191.65\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"814.76,-194.57 825.06,-197.04 818.55,-188.68 814.76,-194.57\"/>\n",
       "<text text-anchor=\"middle\" x=\"594.37\" y=\"-164.2\" font-family=\"Times,serif\" font-size=\"14.00\">&#45;0.49</text>\n",
       "</g>\n",
       "<!-- 15073dc40 -->\n",
       "<g id=\"node16\" class=\"node\">\n",
       "<title>15073dc40</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"475.47\" cy=\"-111\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"475.47\" y=\"-105.95\" font-family=\"Times,serif\" font-size=\"14.00\">Exp</text>\n",
       "</g>\n",
       "<!-- 150766fa0&#45;&gt;15073dc40 -->\n",
       "<g id=\"edge16\" class=\"edge\">\n",
       "<title>150766fa0&#45;&gt;15073dc40</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M384.65,-139.07C391.57,-136.13 399.28,-133.03 406.47,-130.5 416.85,-126.84 428.29,-123.36 438.78,-120.37\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"439.54,-123.8 448.24,-117.75 437.66,-117.05 439.54,-123.8\"/>\n",
       "<text text-anchor=\"middle\" x=\"418.47\" y=\"-133.2\" font-family=\"Times,serif\" font-size=\"14.00\">1.46</text>\n",
       "</g>\n",
       "<!-- 146d40a70 -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>146d40a70</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"594.37\" cy=\"-306\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"594.37\" y=\"-300.95\" font-family=\"Times,serif\" font-size=\"14.00\">Add</text>\n",
       "</g>\n",
       "<!-- 146d919c0&#45;&gt;146d40a70 -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>146d919c0&#45;&gt;146d40a70</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M501.55,-285.58C517.8,-289.19 539.24,-293.96 557.31,-297.98\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"556.33,-301.35 566.85,-300.1 557.85,-294.52 556.33,-301.35\"/>\n",
       "</g>\n",
       "<!-- 1507a7200&#45;&gt;x6 -->\n",
       "<g id=\"edge14\" class=\"edge\">\n",
       "<title>1507a7200&#45;&gt;x6</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M499.85,-226.07C516.96,-231.52 540.85,-238.22 562.47,-241 650.89,-252.39 755.33,-232.62 808.81,-220.1\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"809.35,-223.57 818.26,-217.83 807.72,-216.76 809.35,-223.57\"/>\n",
       "<text text-anchor=\"middle\" x=\"663.02\" y=\"-246.2\" font-family=\"Times,serif\" font-size=\"14.00\">24.26</text>\n",
       "</g>\n",
       "<!-- 1507093c0 -->\n",
       "<g id=\"node15\" class=\"node\">\n",
       "<title>1507093c0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"594.37\" cy=\"-214\" rx=\"31.9\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"594.37\" y=\"-208.95\" font-family=\"Times,serif\" font-size=\"14.00\">13.51</text>\n",
       "</g>\n",
       "<!-- 1507a7200&#45;&gt;1507093c0 -->\n",
       "<g id=\"edge15\" class=\"edge\">\n",
       "<title>1507a7200&#45;&gt;1507093c0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M502.7,-217.1C516.89,-216.62 534.77,-216 550.89,-215.45\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"550.86,-218.96 560.73,-215.12 550.62,-211.96 550.86,-218.96\"/>\n",
       "</g>\n",
       "<!-- x1 -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>x1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"726.77\" cy=\"-360\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"726.77\" y=\"-354.95\" font-family=\"Times,serif\" font-size=\"14.00\">x1</text>\n",
       "</g>\n",
       "<!-- 146d40a70&#45;&gt;x1 -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>146d40a70&#45;&gt;x1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M617.79,-315.28C638.41,-323.82 669.25,-336.59 692.7,-346.3\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"691.23,-349.49 701.81,-350.08 693.91,-343.02 691.23,-349.49\"/>\n",
       "<text text-anchor=\"middle\" x=\"663.02\" y=\"-343.2\" font-family=\"Times,serif\" font-size=\"14.00\">0.87</text>\n",
       "</g>\n",
       "<!-- 1507cd020 -->\n",
       "<g id=\"node12\" class=\"node\">\n",
       "<title>1507cd020</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"726.77\" cy=\"-306\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"726.77\" y=\"-300.95\" font-family=\"Times,serif\" font-size=\"14.00\">Add</text>\n",
       "</g>\n",
       "<!-- 146d40a70&#45;&gt;1507cd020 -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>146d40a70&#45;&gt;1507cd020</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M621.76,-306C640.85,-306 666.92,-306 688.18,-306\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"687.91,-309.5 697.91,-306 687.91,-302.5 687.91,-309.5\"/>\n",
       "</g>\n",
       "<!-- x3 -->\n",
       "<g id=\"node13\" class=\"node\">\n",
       "<title>x3</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"845.27\" cy=\"-333\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"845.27\" y=\"-327.95\" font-family=\"Times,serif\" font-size=\"14.00\">x3</text>\n",
       "</g>\n",
       "<!-- 1507cd020&#45;&gt;x3 -->\n",
       "<g id=\"edge12\" class=\"edge\">\n",
       "<title>1507cd020&#45;&gt;x3</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M752.76,-311.79C768.97,-315.55 790.33,-320.5 808.34,-324.67\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"807.31,-328.03 817.85,-326.88 808.9,-321.21 807.31,-328.03\"/>\n",
       "<text text-anchor=\"middle\" x=\"786.02\" y=\"-325.2\" font-family=\"Times,serif\" font-size=\"14.00\">&#45;0.60</text>\n",
       "</g>\n",
       "<!-- 1507cd020&#45;&gt;x6 -->\n",
       "<g id=\"edge13\" class=\"edge\">\n",
       "<title>1507cd020&#45;&gt;x6</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M751.33,-298.02C766.4,-292.14 785.77,-283.07 800.27,-271 811.49,-261.67 821.37,-248.9 828.91,-237.53\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"831.72,-239.64 834.1,-229.31 825.8,-235.9 831.72,-239.64\"/>\n",
       "<text text-anchor=\"middle\" x=\"786.02\" y=\"-291.2\" font-family=\"Times,serif\" font-size=\"14.00\">0.17</text>\n",
       "</g>\n",
       "<!-- 1507d5ba0 -->\n",
       "<g id=\"node17\" class=\"node\">\n",
       "<title>1507d5ba0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"594.37\" cy=\"-107\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"594.37\" y=\"-101.95\" font-family=\"Times,serif\" font-size=\"14.00\">Sin</text>\n",
       "</g>\n",
       "<!-- 15073dc40&#45;&gt;1507d5ba0 -->\n",
       "<g id=\"edge18\" class=\"edge\">\n",
       "<title>15073dc40&#45;&gt;1507d5ba0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M502.7,-110.1C518.34,-109.57 538.46,-108.88 555.78,-108.29\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"555.83,-111.79 565.71,-107.95 555.6,-104.79 555.83,-111.79\"/>\n",
       "<text text-anchor=\"middle\" x=\"532.47\" y=\"-112.2\" font-family=\"Times,serif\" font-size=\"14.00\">0.11</text>\n",
       "</g>\n",
       "<!-- x0 -->\n",
       "<g id=\"node18\" class=\"node\">\n",
       "<title>x0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"726.77\" cy=\"-76\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"726.77\" y=\"-70.95\" font-family=\"Times,serif\" font-size=\"14.00\">x0</text>\n",
       "</g>\n",
       "<!-- 1507d5ba0&#45;&gt;x0 -->\n",
       "<g id=\"edge19\" class=\"edge\">\n",
       "<title>1507d5ba0&#45;&gt;x0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M620.2,-101.1C639.96,-96.4 667.88,-89.76 690.04,-84.49\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"690.64,-87.95 699.56,-82.23 689.02,-81.14 690.64,-87.95\"/>\n",
       "<text text-anchor=\"middle\" x=\"663.02\" y=\"-98.2\" font-family=\"Times,serif\" font-size=\"14.00\">219.51</text>\n",
       "</g>\n",
       "<!-- 150175c60 -->\n",
       "<g id=\"node20\" class=\"node\">\n",
       "<title>150175c60</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"594.37\" cy=\"-53\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"594.37\" y=\"-47.95\" font-family=\"Times,serif\" font-size=\"14.00\">Sin</text>\n",
       "</g>\n",
       "<!-- 150771ef0&#45;&gt;150175c60 -->\n",
       "<g id=\"edge22\" class=\"edge\">\n",
       "<title>150771ef0&#45;&gt;150175c60</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M502.7,-53C518.34,-53 538.46,-53 555.78,-53\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"555.71,-56.5 565.71,-53 555.71,-49.5 555.71,-56.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"532.47\" y=\"-56.2\" font-family=\"Times,serif\" font-size=\"14.00\">1.94</text>\n",
       "</g>\n",
       "<!-- 150175c60&#45;&gt;x0 -->\n",
       "<g id=\"edge23\" class=\"edge\">\n",
       "<title>150175c60&#45;&gt;x0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M621.21,-55.6C638.45,-57.54 661.58,-60.53 681.77,-64.5 684.72,-65.08 687.77,-65.74 690.81,-66.45\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"689.67,-69.77 700.22,-68.77 691.35,-62.97 689.67,-69.77\"/>\n",
       "<text text-anchor=\"middle\" x=\"663.02\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">218.45</text>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.sources.Source at 0x1462c9d10>"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model = est.best_estimator_.get_dot_model(\"rankdir=LR;\")\n",
    "graphviz.Source(model)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "512434e7",
   "metadata": {},
   "source": [
    "### A classification example"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "4ca564f3",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Completed 100% [====================]\n",
      "saving final population as archive...\n",
      "Best model: Logistic\n",
      "|- 0.35+Sum\n",
      "|  |- If(AIDS>15890.50)\n",
      "|  |  |- 15.16\n",
      "|  |  |- If(Total>1572255.50)\n",
      "|  |  |  |- If(AIDS>2320.50)\n",
      "|  |  |  |  |- If(Age>0.00)\n",
      "|  |  |  |  |  |- 13.24\n",
      "|  |  |  |  |  |- If(Age>4.00)\n",
      "|  |  |  |  |  |  |- If(AIDS>3604.00)\n",
      "|  |  |  |  |  |  |  |- 14.72\n",
      "|  |  |  |  |  |  |  |- -7.84\n",
      "|  |  |  |  |  |  |- 3604.00\n",
      "|  |  |  |  |- Total\n",
      "|  |  |  |- If(AIDS>123.00)\n",
      "|  |  |  |  |- If(AIDS>1653.50)\n",
      "|  |  |  |  |  |- If(AIDS>6597.50)\n",
      "|  |  |  |  |  |  |- 15.89\n",
      "|  |  |  |  |  |  |- -7.42\n",
      "|  |  |  |  |  |- 9.78\n",
      "|  |  |  |  |- If(AIDS>51.50)\n",
      "|  |  |  |  |  |- 2320.50\n",
      "|  |  |  |  |  |- If(AIDS>20.00)\n",
      "|  |  |  |  |  |  |- If(Total>168995.50)\n",
      "|  |  |  |  |  |  |  |- 14.60\n",
      "|  |  |  |  |  |  |  |- Total\n",
      "|  |  |  |  |  |  |- Total\n"
     ]
    }
   ],
   "source": [
    "from pybrush import BrushClassifier\n",
    "from sklearn.preprocessing import StandardScaler\n",
    "\n",
    "# load data\n",
    "df = pd.read_csv('../examples/datasets/d_analcatdata_aids.csv')\n",
    "X = df.drop(columns='target')\n",
    "y = df['target']\n",
    "\n",
    "est = BrushClassifier(\n",
    "    functions=['SplitBest', 'And', 'Sin', 'Cos', 'Exp'],\n",
    "    max_gens=500,\n",
    "    max_size=50,\n",
    "    max_depth=15,\n",
    "    objectives=[\"scorer\", \"linear_complexity\"],  \n",
    "    scorer=\"log\",\n",
    "    pop_size=100,\n",
    "    bandit='dynamic_thompson',\n",
    "    verbosity=1\n",
    ")\n",
    "\n",
    "est.fit(X,y)\n",
    "\n",
    "print(\"Best model:\", est.best_estimator_.get_model(\"tree\"))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b1e8c636",
   "metadata": {},
   "source": [
    "Notice that classification problems have a fixed logistic root on their programs. When printing the dot model, Brush will highlight fixed nodes using a light coral color."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "05a76db6",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "=== Search space ===\n",
      "terminal_map: {\"ArrayB\": [\"1.00\", \"1.00\"], \"ArrayI\": [\"Age\", \"Race\", \"1.00\"], \"ArrayF\": [\"AIDS\", \"Total\", \"1.00\"]}\n",
      "terminal_weights: {\"ArrayB\": [0.8793828, 0.52116793], \"ArrayI\": [0.32256046, 0.26764607, 0.30504623], \"ArrayF\": [0.50462556, 0.3645889, 0.4741492]}\n",
      "SplitBest node_map[ArrayI][[\"ArrayI\", \"ArrayI\"]][SplitBest] = 1.00*SplitBest, weight = 0.79916525\n",
      "OffsetSum node_map[MatrixF][[\"ArrayF\", \"ArrayF\", \"ArrayF\", \"ArrayF\"]][OffsetSum] = 0.00+Sum, weight = 0\n",
      "Logistic node_map[MatrixF][[\"ArrayF\", \"ArrayF\", \"ArrayF\", \"ArrayF\"]][Logistic] = 1.00*Logistic, weight = 0\n",
      "Sin node_map[MatrixF][[\"ArrayF\", \"ArrayF\", \"ArrayF\", \"ArrayF\"]][Sin] = 1.00*Sin, weight = 0.78019255\n",
      "Cos node_map[MatrixF][[\"ArrayF\", \"ArrayF\", \"ArrayF\", \"ArrayF\"]][Cos] = 1.00*Cos, weight = 0.41319987\n",
      "Exp node_map[MatrixF][[\"ArrayF\", \"ArrayF\", \"ArrayF\", \"ArrayF\"]][Exp] = 1.00*Exp, weight = 0.81880784\n",
      "OffsetSum node_map[MatrixF][[\"ArrayF\", \"ArrayF\", \"ArrayF\"]][OffsetSum] = 0.00+Sum, weight = 0\n",
      "Logistic node_map[MatrixF][[\"ArrayF\", \"ArrayF\", \"ArrayF\"]][Logistic] = 1.00*Logistic, weight = 0\n",
      "Sin node_map[MatrixF][[\"ArrayF\", \"ArrayF\", \"ArrayF\"]][Sin] = 1.00*Sin, weight = 0.528029\n",
      "Cos node_map[MatrixF][[\"ArrayF\", \"ArrayF\", \"ArrayF\"]][Cos] = 1.00*Cos, weight = 0.83539855\n",
      "Exp node_map[MatrixF][[\"ArrayF\", \"ArrayF\", \"ArrayF\"]][Exp] = 1.00*Exp, weight = 0.85179526\n",
      "OffsetSum node_map[MatrixF][[\"ArrayF\", \"ArrayF\"]][OffsetSum] = 0.00+Sum, weight = 0\n",
      "Logistic node_map[MatrixF][[\"ArrayF\", \"ArrayF\"]][Logistic] = 1.00*Logistic, weight = 0\n",
      "Sin node_map[MatrixF][[\"ArrayF\", \"ArrayF\"]][Sin] = 1.00*Sin, weight = 0.36013472\n",
      "Cos node_map[MatrixF][[\"ArrayF\", \"ArrayF\"]][Cos] = 1.00*Cos, weight = 0.49711952\n",
      "Exp node_map[MatrixF][[\"ArrayF\", \"ArrayF\"]][Exp] = 1.00*Exp, weight = 0.63099563\n",
      "SplitBest node_map[ArrayF][[\"ArrayF\", \"ArrayF\"]][SplitBest] = 1.00*SplitBest, weight = 0.36976478\n",
      "OffsetSum node_map[ArrayF][[\"ArrayF\"]][OffsetSum] = 0.00+Sum, weight = 0\n",
      "Logistic node_map[ArrayF][[\"ArrayF\"]][Logistic] = 1.00*Logistic, weight = 0\n",
      "Sin node_map[ArrayF][[\"ArrayF\"]][Sin] = 1.00*Sin, weight = 0.37509245\n",
      "Cos node_map[ArrayF][[\"ArrayF\"]][Cos] = 1.00*Cos, weight = 0.45842174\n",
      "Exp node_map[ArrayF][[\"ArrayF\"]][Exp] = 1.00*Exp, weight = 0.5415648\n",
      "\n",
      "Best model: Logistic(Sum(0.35,If(AIDS>15890.50,15.16,If(Total>1572255.50,If(AIDS>2320.50,If(Age>0.00,13.24,If(Age>4.00,If(AIDS>3604.00,14.72,-7.84),3604.00)),Total),If(AIDS>123.00,If(AIDS>1653.50,If(AIDS>6597.50,15.89,-7.42),9.78),If(AIDS>51.50,2320.50,If(AIDS>20.00,If(Total>168995.50,14.60,Total),Total)))))))\n",
      "score: 0.54\n",
      "Best model: Logistic\n",
      "|- 0.35+Sum\n",
      "|  |- If(AIDS>15890.50)\n",
      "|  |  |- 15.16\n",
      "|  |  |- If(Total>1572255.50)\n",
      "|  |  |  |- If(AIDS>2320.50)\n",
      "|  |  |  |  |- If(Age>0.00)\n",
      "|  |  |  |  |  |- 13.24\n",
      "|  |  |  |  |  |- If(Age>4.00)\n",
      "|  |  |  |  |  |  |- If(AIDS>3604.00)\n",
      "|  |  |  |  |  |  |  |- 14.72\n",
      "|  |  |  |  |  |  |  |- -7.84\n",
      "|  |  |  |  |  |  |- 3604.00\n",
      "|  |  |  |  |- Total\n",
      "|  |  |  |- If(AIDS>123.00)\n",
      "|  |  |  |  |- If(AIDS>1653.50)\n",
      "|  |  |  |  |  |- If(AIDS>6597.50)\n",
      "|  |  |  |  |  |  |- 15.89\n",
      "|  |  |  |  |  |  |- -7.42\n",
      "|  |  |  |  |  |- 9.78\n",
      "|  |  |  |  |- If(AIDS>51.50)\n",
      "|  |  |  |  |  |- 2320.50\n",
      "|  |  |  |  |  |- If(AIDS>20.00)\n",
      "|  |  |  |  |  |  |- If(Total>168995.50)\n",
      "|  |  |  |  |  |  |  |- 14.60\n",
      "|  |  |  |  |  |  |  |- Total\n",
      "|  |  |  |  |  |  |- Total\n"
     ]
    },
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 12.0.0 (0)\n",
       " -->\n",
       "<!-- Title: G Pages: 1 -->\n",
       "<svg width=\"791pt\" height=\"620pt\"\n",
       " viewBox=\"0.00 0.00 790.84 620.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 616)\">\n",
       "<title>G</title>\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-616 786.84,-616 786.84,4 -4,4\"/>\n",
       "<!-- 146bf4320 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>146bf4320</title>\n",
       "<ellipse fill=\"lightcoral\" stroke=\"black\" cx=\"348.34\" cy=\"-594\" rx=\"41.12\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"348.34\" y=\"-588.95\" font-family=\"Times,serif\" font-size=\"14.00\">Logistic</text>\n",
       "</g>\n",
       "<!-- 15176af20 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>15176af20</title>\n",
       "<ellipse fill=\"lightcoral\" stroke=\"black\" cx=\"348.34\" cy=\"-522\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"348.34\" y=\"-516.95\" font-family=\"Times,serif\" font-size=\"14.00\">Add</text>\n",
       "</g>\n",
       "<!-- 146bf4320&#45;&gt;15176af20 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>146bf4320&#45;&gt;15176af20</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M348.34,-575.7C348.34,-568.41 348.34,-559.73 348.34,-551.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"351.84,-551.62 348.34,-541.62 344.84,-551.62 351.84,-551.62\"/>\n",
       "</g>\n",
       "<!-- 146b21330 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>146b21330</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"287.34\" cy=\"-450\" rx=\"76.94\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"287.34\" y=\"-444.95\" font-family=\"Times,serif\" font-size=\"14.00\">AIDS&gt;15890.50?</text>\n",
       "</g>\n",
       "<!-- 15176af20&#45;&gt;146b21330 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>15176af20&#45;&gt;146b21330</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M335.1,-505.81C327.7,-497.31 318.27,-486.49 309.75,-476.72\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"312.46,-474.51 303.25,-469.27 307.19,-479.11 312.46,-474.51\"/>\n",
       "</g>\n",
       "<!-- 15176af20Offset -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>15176af20Offset</title>\n",
       "<ellipse fill=\"lightcoral\" stroke=\"black\" cx=\"409.34\" cy=\"-450\" rx=\"27.3\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"409.34\" y=\"-444.95\" font-family=\"Times,serif\" font-size=\"14.00\">0.35</text>\n",
       "</g>\n",
       "<!-- 15176af20&#45;&gt;15176af20Offset -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>15176af20&#45;&gt;15176af20Offset</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M361.57,-505.81C369.49,-496.73 379.71,-485 388.67,-474.72\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"391.2,-477.14 395.13,-467.3 385.92,-472.54 391.2,-477.14\"/>\n",
       "</g>\n",
       "<!-- 1469faf60 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>1469faf60</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"220.34\" cy=\"-378\" rx=\"31.9\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"220.34\" y=\"-372.95\" font-family=\"Times,serif\" font-size=\"14.00\">15.16</text>\n",
       "</g>\n",
       "<!-- 146b21330&#45;&gt;1469faf60 -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>146b21330&#45;&gt;1469faf60</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M271.12,-432.05C262.61,-423.17 252.06,-412.14 242.78,-402.45\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"245.52,-400.25 236.08,-395.45 240.47,-405.09 245.52,-400.25\"/>\n",
       "<text text-anchor=\"middle\" x=\"266.24\" y=\"-418.75\" font-family=\"Times,serif\" font-size=\"14.00\">Y</text>\n",
       "</g>\n",
       "<!-- 1469c37c0 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>1469c37c0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"354.34\" cy=\"-378\" rx=\"84.11\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"354.34\" y=\"-372.95\" font-family=\"Times,serif\" font-size=\"14.00\">Total&gt;1572255.50?</text>\n",
       "</g>\n",
       "<!-- 146b21330&#45;&gt;1469c37c0 -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>146b21330&#45;&gt;1469c37c0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M303.55,-432.05C311.62,-423.63 321.52,-413.28 330.44,-403.97\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"332.83,-406.53 337.22,-396.88 327.78,-401.69 332.83,-406.53\"/>\n",
       "<text text-anchor=\"middle\" x=\"298.68\" y=\"-418.75\" font-family=\"Times,serif\" font-size=\"14.00\">N</text>\n",
       "</g>\n",
       "<!-- 14693df50 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>14693df50</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"275.34\" cy=\"-306\" rx=\"72.34\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"275.34\" y=\"-300.95\" font-family=\"Times,serif\" font-size=\"14.00\">AIDS&gt;2320.50?</text>\n",
       "</g>\n",
       "<!-- 1469c37c0&#45;&gt;14693df50 -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>1469c37c0&#45;&gt;14693df50</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M335.21,-360.05C325.51,-351.46 313.55,-340.86 302.87,-331.4\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"305.22,-328.81 295.42,-324.79 300.58,-334.04 305.22,-328.81\"/>\n",
       "<text text-anchor=\"middle\" x=\"330.34\" y=\"-346.75\" font-family=\"Times,serif\" font-size=\"14.00\">Y</text>\n",
       "</g>\n",
       "<!-- 318c0b8f0 -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>318c0b8f0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"433.34\" cy=\"-306\" rx=\"67.73\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"433.34\" y=\"-300.95\" font-family=\"Times,serif\" font-size=\"14.00\">AIDS&gt;123.00?</text>\n",
       "</g>\n",
       "<!-- 1469c37c0&#45;&gt;318c0b8f0 -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>1469c37c0&#45;&gt;318c0b8f0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M373.46,-360.05C383.33,-351.31 395.54,-340.49 406.36,-330.9\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"408.36,-333.8 413.53,-324.55 403.72,-328.56 408.36,-333.8\"/>\n",
       "<text text-anchor=\"middle\" x=\"368.58\" y=\"-346.75\" font-family=\"Times,serif\" font-size=\"14.00\">N</text>\n",
       "</g>\n",
       "<!-- 14699b840 -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>14699b840</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"197.34\" cy=\"-234\" rx=\"52.38\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"197.34\" y=\"-228.95\" font-family=\"Times,serif\" font-size=\"14.00\">Age&gt;0.00?</text>\n",
       "</g>\n",
       "<!-- 14693df50&#45;&gt;14699b840 -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>14693df50&#45;&gt;14699b840</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M256.85,-288.41C246.97,-279.54 234.63,-268.47 223.75,-258.71\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"226.33,-256.31 216.55,-252.24 221.65,-261.52 226.33,-256.31\"/>\n",
       "<text text-anchor=\"middle\" x=\"251.98\" y=\"-275.11\" font-family=\"Times,serif\" font-size=\"14.00\">Y</text>\n",
       "</g>\n",
       "<!-- Total -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>Total</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"595.34\" cy=\"-18\" rx=\"30.37\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"595.34\" y=\"-12.95\" font-family=\"Times,serif\" font-size=\"14.00\">Total</text>\n",
       "</g>\n",
       "<!-- 14693df50&#45;&gt;Total -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>14693df50&#45;&gt;Total</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M272.19,-287.73C265.36,-244.13 254.37,-129.01 316.34,-72 350.38,-40.68 484.41,-26.8 553.56,-21.62\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"553.65,-25.12 563.37,-20.91 553.15,-18.14 553.65,-25.12\"/>\n",
       "<text text-anchor=\"middle\" x=\"267.32\" y=\"-274.43\" font-family=\"Times,serif\" font-size=\"14.00\">N</text>\n",
       "</g>\n",
       "<!-- 318c09e20 -->\n",
       "<g id=\"node17\" class=\"node\">\n",
       "<title>318c09e20</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"431.34\" cy=\"-234\" rx=\"72.34\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"431.34\" y=\"-228.95\" font-family=\"Times,serif\" font-size=\"14.00\">AIDS&gt;1653.50?</text>\n",
       "</g>\n",
       "<!-- 318c0b8f0&#45;&gt;318c09e20 -->\n",
       "<g id=\"edge16\" class=\"edge\">\n",
       "<title>318c0b8f0&#45;&gt;318c09e20</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M432.84,-287.7C432.63,-280.41 432.38,-271.73 432.15,-263.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"435.65,-263.51 431.87,-253.62 428.65,-263.71 435.65,-263.51\"/>\n",
       "<text text-anchor=\"middle\" x=\"427.97\" y=\"-274.4\" font-family=\"Times,serif\" font-size=\"14.00\">Y</text>\n",
       "</g>\n",
       "<!-- 318c09300 -->\n",
       "<g id=\"node18\" class=\"node\">\n",
       "<title>318c09300</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"584.34\" cy=\"-234\" rx=\"63.12\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"584.34\" y=\"-228.95\" font-family=\"Times,serif\" font-size=\"14.00\">AIDS&gt;51.50?</text>\n",
       "</g>\n",
       "<!-- 318c0b8f0&#45;&gt;318c09300 -->\n",
       "<g id=\"edge17\" class=\"edge\">\n",
       "<title>318c0b8f0&#45;&gt;318c09300</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M466.1,-289.81C488.31,-279.51 517.89,-265.8 541.9,-254.67\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"543.18,-257.94 550.78,-250.56 540.24,-251.59 543.18,-257.94\"/>\n",
       "<text text-anchor=\"middle\" x=\"461.23\" y=\"-276.51\" font-family=\"Times,serif\" font-size=\"14.00\">N</text>\n",
       "</g>\n",
       "<!-- 14691dae0 -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>14691dae0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"95.34\" cy=\"-162\" rx=\"31.9\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"95.34\" y=\"-156.95\" font-family=\"Times,serif\" font-size=\"14.00\">13.24</text>\n",
       "</g>\n",
       "<!-- 14699b840&#45;&gt;14691dae0 -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>14699b840&#45;&gt;14691dae0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M174.7,-217.46C159.92,-207.32 140.49,-193.99 124.55,-183.05\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"126.63,-180.23 116.4,-177.46 122.67,-186 126.63,-180.23\"/>\n",
       "<text text-anchor=\"middle\" x=\"172.26\" y=\"-204.16\" font-family=\"Times,serif\" font-size=\"14.00\">Y</text>\n",
       "</g>\n",
       "<!-- 14691b040 -->\n",
       "<g id=\"node12\" class=\"node\">\n",
       "<title>14691b040</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"197.34\" cy=\"-162\" rx=\"52.38\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"197.34\" y=\"-156.95\" font-family=\"Times,serif\" font-size=\"14.00\">Age&gt;4.00?</text>\n",
       "</g>\n",
       "<!-- 14699b840&#45;&gt;14691b040 -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>14699b840&#45;&gt;14691b040</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M197.34,-215.7C197.34,-208.41 197.34,-199.73 197.34,-191.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"200.84,-191.62 197.34,-181.62 193.84,-191.62 200.84,-191.62\"/>\n",
       "<text text-anchor=\"middle\" x=\"192.46\" y=\"-202.4\" font-family=\"Times,serif\" font-size=\"14.00\">N</text>\n",
       "</g>\n",
       "<!-- 157b8f8b0 -->\n",
       "<g id=\"node13\" class=\"node\">\n",
       "<title>157b8f8b0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72.34\" cy=\"-90\" rx=\"72.34\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72.34\" y=\"-84.95\" font-family=\"Times,serif\" font-size=\"14.00\">AIDS&gt;3604.00?</text>\n",
       "</g>\n",
       "<!-- 14691b040&#45;&gt;157b8f8b0 -->\n",
       "<g id=\"edge12\" class=\"edge\">\n",
       "<title>14691b040&#45;&gt;157b8f8b0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M170.83,-146.15C153.25,-136.31 129.91,-123.24 110.37,-112.3\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"112.3,-109.37 101.86,-107.54 108.88,-115.48 112.3,-109.37\"/>\n",
       "<text text-anchor=\"middle\" x=\"173.26\" y=\"-132.85\" font-family=\"Times,serif\" font-size=\"14.00\">Y</text>\n",
       "</g>\n",
       "<!-- 16c030a30 -->\n",
       "<g id=\"node14\" class=\"node\">\n",
       "<title>16c030a30</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"203.34\" cy=\"-90\" rx=\"41.12\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"203.34\" y=\"-84.95\" font-family=\"Times,serif\" font-size=\"14.00\">3604.00</text>\n",
       "</g>\n",
       "<!-- 14691b040&#45;&gt;16c030a30 -->\n",
       "<g id=\"edge13\" class=\"edge\">\n",
       "<title>14691b040&#45;&gt;16c030a30</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M198.82,-143.7C199.44,-136.41 200.19,-127.73 200.89,-119.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"204.37,-119.87 201.74,-109.61 197.4,-119.28 204.37,-119.87\"/>\n",
       "<text text-anchor=\"middle\" x=\"193.94\" y=\"-130.4\" font-family=\"Times,serif\" font-size=\"14.00\">N</text>\n",
       "</g>\n",
       "<!-- 157b8dee0 -->\n",
       "<g id=\"node15\" class=\"node\">\n",
       "<title>157b8dee0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"32.34\" cy=\"-18\" rx=\"31.9\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"32.34\" y=\"-12.95\" font-family=\"Times,serif\" font-size=\"14.00\">14.72</text>\n",
       "</g>\n",
       "<!-- 157b8f8b0&#45;&gt;157b8dee0 -->\n",
       "<g id=\"edge14\" class=\"edge\">\n",
       "<title>157b8f8b0&#45;&gt;157b8dee0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M62.45,-71.7C57.93,-63.78 52.47,-54.23 47.44,-45.44\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"50.59,-43.88 42.58,-36.94 44.51,-47.36 50.59,-43.88\"/>\n",
       "<text text-anchor=\"middle\" x=\"57.57\" y=\"-58.4\" font-family=\"Times,serif\" font-size=\"14.00\">Y</text>\n",
       "</g>\n",
       "<!-- 16c03c6b0 -->\n",
       "<g id=\"node16\" class=\"node\">\n",
       "<title>16c03c6b0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"112.34\" cy=\"-18\" rx=\"30.37\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"112.34\" y=\"-12.95\" font-family=\"Times,serif\" font-size=\"14.00\">&#45;7.84</text>\n",
       "</g>\n",
       "<!-- 157b8f8b0&#45;&gt;16c03c6b0 -->\n",
       "<g id=\"edge15\" class=\"edge\">\n",
       "<title>157b8f8b0&#45;&gt;16c03c6b0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M82.22,-71.7C86.81,-63.67 92.37,-53.95 97.45,-45.05\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"100.44,-46.88 102.36,-36.46 94.36,-43.4 100.44,-46.88\"/>\n",
       "<text text-anchor=\"middle\" x=\"77.35\" y=\"-58.4\" font-family=\"Times,serif\" font-size=\"14.00\">N</text>\n",
       "</g>\n",
       "<!-- 318c04dd0 -->\n",
       "<g id=\"node19\" class=\"node\">\n",
       "<title>318c04dd0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"377.34\" cy=\"-162\" rx=\"72.34\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"377.34\" y=\"-156.95\" font-family=\"Times,serif\" font-size=\"14.00\">AIDS&gt;6597.50?</text>\n",
       "</g>\n",
       "<!-- 318c09e20&#45;&gt;318c04dd0 -->\n",
       "<g id=\"edge18\" class=\"edge\">\n",
       "<title>318c09e20&#45;&gt;318c04dd0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M418.26,-216.05C411.96,-207.89 404.27,-197.91 397.26,-188.82\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"400.09,-186.77 391.21,-180.99 394.55,-191.04 400.09,-186.77\"/>\n",
       "<text text-anchor=\"middle\" x=\"413.39\" y=\"-202.75\" font-family=\"Times,serif\" font-size=\"14.00\">Y</text>\n",
       "</g>\n",
       "<!-- 318c141c0 -->\n",
       "<g id=\"node20\" class=\"node\">\n",
       "<title>318c141c0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"495.34\" cy=\"-162\" rx=\"27.3\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"495.34\" y=\"-156.95\" font-family=\"Times,serif\" font-size=\"14.00\">9.78</text>\n",
       "</g>\n",
       "<!-- 318c09e20&#45;&gt;318c141c0 -->\n",
       "<g id=\"edge19\" class=\"edge\">\n",
       "<title>318c09e20&#45;&gt;318c141c0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M446.83,-216.05C454.99,-207.13 465.11,-196.06 474,-186.33\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"476.54,-188.75 480.7,-179.01 471.37,-184.02 476.54,-188.75\"/>\n",
       "<text text-anchor=\"middle\" x=\"441.95\" y=\"-202.75\" font-family=\"Times,serif\" font-size=\"14.00\">N</text>\n",
       "</g>\n",
       "<!-- 318c172f0 -->\n",
       "<g id=\"node23\" class=\"node\">\n",
       "<title>318c172f0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"581.34\" cy=\"-162\" rx=\"41.12\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"581.34\" y=\"-156.95\" font-family=\"Times,serif\" font-size=\"14.00\">2320.50</text>\n",
       "</g>\n",
       "<!-- 318c09300&#45;&gt;318c172f0 -->\n",
       "<g id=\"edge22\" class=\"edge\">\n",
       "<title>318c09300&#45;&gt;318c172f0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M583.59,-215.7C583.28,-208.41 582.91,-199.73 582.56,-191.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"586.06,-191.46 582.13,-181.62 579.06,-191.76 586.06,-191.46\"/>\n",
       "<text text-anchor=\"middle\" x=\"578.72\" y=\"-202.4\" font-family=\"Times,serif\" font-size=\"14.00\">Y</text>\n",
       "</g>\n",
       "<!-- 318c0d250 -->\n",
       "<g id=\"node24\" class=\"node\">\n",
       "<title>318c0d250</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"703.34\" cy=\"-162\" rx=\"63.12\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"703.34\" y=\"-156.95\" font-family=\"Times,serif\" font-size=\"14.00\">AIDS&gt;20.00?</text>\n",
       "</g>\n",
       "<!-- 318c09300&#45;&gt;318c0d250 -->\n",
       "<g id=\"edge23\" class=\"edge\">\n",
       "<title>318c09300&#45;&gt;318c0d250</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M611.04,-217.29C627.5,-207.61 648.83,-195.06 666.84,-184.47\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"668.57,-187.51 675.41,-179.42 665.02,-181.48 668.57,-187.51\"/>\n",
       "<text text-anchor=\"middle\" x=\"606.17\" y=\"-203.99\" font-family=\"Times,serif\" font-size=\"14.00\">N</text>\n",
       "</g>\n",
       "<!-- 318c066d0 -->\n",
       "<g id=\"node21\" class=\"node\">\n",
       "<title>318c066d0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"357.34\" cy=\"-90\" rx=\"31.9\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"357.34\" y=\"-84.95\" font-family=\"Times,serif\" font-size=\"14.00\">15.89</text>\n",
       "</g>\n",
       "<!-- 318c04dd0&#45;&gt;318c066d0 -->\n",
       "<g id=\"edge20\" class=\"edge\">\n",
       "<title>318c04dd0&#45;&gt;318c066d0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M372.39,-143.7C370.26,-136.24 367.71,-127.32 365.33,-118.97\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"368.75,-118.21 362.64,-109.56 362.02,-120.14 368.75,-118.21\"/>\n",
       "<text text-anchor=\"middle\" x=\"367.52\" y=\"-130.4\" font-family=\"Times,serif\" font-size=\"14.00\">Y</text>\n",
       "</g>\n",
       "<!-- 318c04c70 -->\n",
       "<g id=\"node22\" class=\"node\">\n",
       "<title>318c04c70</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"437.34\" cy=\"-90\" rx=\"30.37\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"437.34\" y=\"-84.95\" font-family=\"Times,serif\" font-size=\"14.00\">&#45;7.42</text>\n",
       "</g>\n",
       "<!-- 318c04dd0&#45;&gt;318c04c70 -->\n",
       "<g id=\"edge21\" class=\"edge\">\n",
       "<title>318c04dd0&#45;&gt;318c04c70</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M391.86,-144.05C399.32,-135.35 408.55,-124.59 416.73,-115.03\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"419.34,-117.38 423.19,-107.51 414.02,-112.82 419.34,-117.38\"/>\n",
       "<text text-anchor=\"middle\" x=\"386.98\" y=\"-130.75\" font-family=\"Times,serif\" font-size=\"14.00\">N</text>\n",
       "</g>\n",
       "<!-- 318c0d250&#45;&gt;Total -->\n",
       "<g id=\"edge25\" class=\"edge\">\n",
       "<title>318c0d250&#45;&gt;Total</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M665.77,-147.08C647.59,-138.49 627.01,-125.68 614.34,-108 601.8,-90.51 597.22,-66.45 595.69,-47.75\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"599.19,-47.67 595.15,-37.87 592.2,-48.05 599.19,-47.67\"/>\n",
       "<text text-anchor=\"middle\" x=\"663.33\" y=\"-133.78\" font-family=\"Times,serif\" font-size=\"14.00\">N</text>\n",
       "</g>\n",
       "<!-- 318c0a7c0 -->\n",
       "<g id=\"node25\" class=\"node\">\n",
       "<title>318c0a7c0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"703.34\" cy=\"-90\" rx=\"79.5\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"703.34\" y=\"-84.95\" font-family=\"Times,serif\" font-size=\"14.00\">Total&gt;168995.50?</text>\n",
       "</g>\n",
       "<!-- 318c0d250&#45;&gt;318c0a7c0 -->\n",
       "<g id=\"edge24\" class=\"edge\">\n",
       "<title>318c0d250&#45;&gt;318c0a7c0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M703.34,-143.7C703.34,-136.41 703.34,-127.73 703.34,-119.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"706.84,-119.62 703.34,-109.62 699.84,-119.62 706.84,-119.62\"/>\n",
       "<text text-anchor=\"middle\" x=\"698.46\" y=\"-130.4\" font-family=\"Times,serif\" font-size=\"14.00\">Y</text>\n",
       "</g>\n",
       "<!-- 318c0a7c0&#45;&gt;Total -->\n",
       "<g id=\"edge27\" class=\"edge\">\n",
       "<title>318c0a7c0&#45;&gt;Total</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M678.01,-72.59C661.96,-62.18 641.15,-48.69 624.42,-37.85\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"626.67,-35.14 616.38,-32.64 622.87,-41.01 626.67,-35.14\"/>\n",
       "<text text-anchor=\"middle\" x=\"673.14\" y=\"-59.29\" font-family=\"Times,serif\" font-size=\"14.00\">N</text>\n",
       "</g>\n",
       "<!-- 318c0a2f0 -->\n",
       "<g id=\"node26\" class=\"node\">\n",
       "<title>318c0a2f0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"703.34\" cy=\"-18\" rx=\"31.9\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"703.34\" y=\"-12.95\" font-family=\"Times,serif\" font-size=\"14.00\">14.60</text>\n",
       "</g>\n",
       "<!-- 318c0a7c0&#45;&gt;318c0a2f0 -->\n",
       "<g id=\"edge26\" class=\"edge\">\n",
       "<title>318c0a7c0&#45;&gt;318c0a2f0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M703.34,-71.7C703.34,-64.41 703.34,-55.73 703.34,-47.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"706.84,-47.62 703.34,-37.62 699.84,-47.62 706.84,-47.62\"/>\n",
       "<text text-anchor=\"middle\" x=\"698.46\" y=\"-58.4\" font-family=\"Times,serif\" font-size=\"14.00\">Y</text>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.sources.Source at 0x150bb0c30>"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "est.engine_.search_space.print()\n",
    "\n",
    "print(\"Best model:\", est.best_estimator_.get_model())\n",
    "print('score:', est.score(X,y))\n",
    "\n",
    "print(\"Best model:\", est.best_estimator_.get_model(\"tree\"))\n",
    "\n",
    "model = est.best_estimator_.get_dot_model()\n",
    "graphviz.Source(model)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "brush",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.13.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
