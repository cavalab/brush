<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.1" xml:lang="en-US">
  <compounddef id="d3/dac/estimator_8py" kind="file" language="Python">
    <compoundname>estimator.py</compoundname>
    <innerclass refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator" prot="public">brush::estimator::BrushEstimator</innerclass>
    <innerclass refid="d0/d6a/classbrush_1_1estimator_1_1BrushClassifier" prot="public">brush::estimator::BrushClassifier</innerclass>
    <innerclass refid="da/d81/classbrush_1_1estimator_1_1BrushRegressor" prot="public">brush::estimator::BrushRegressor</innerclass>
    <innernamespace refid="d9/dbc/namespacebrush_1_1estimator">brush::estimator</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1" refid="d9/dbc/namespacebrush_1_1estimator" refkind="compound"><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2"><highlight class="stringliteral">sklearn-compatible<sp/>wrapper<sp/>for<sp/>GP<sp/>analyses.</highlight></codeline>
<codeline lineno="3"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="4"><highlight class="stringliteral">See<sp/>brushgp.cpp<sp/>for<sp/>Python<sp/>(via<sp/>pybind11)<sp/>modules<sp/>that<sp/>give<sp/>more<sp/>fine-grained</highlight></codeline>
<codeline lineno="5"><highlight class="stringliteral">control<sp/>of<sp/>the<sp/>underlying<sp/>GP<sp/>objects.</highlight></codeline>
<codeline lineno="6"><highlight class="stringliteral">&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>sklearn.base<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>BaseEstimator,<sp/>ClassifierMixin,<sp/>RegressorMixin,<sp/>TransformerMixin</highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="comment">#<sp/>from<sp/>sklearn.metrics<sp/>import<sp/>mean_squared_error</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>numpy<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>np</highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>pandas<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>pd</highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="comment">#<sp/>import<sp/>deap<sp/>as<sp/>dp</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>deap<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>algorithms,<sp/>base,<sp/>creator,<sp/>tools</highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="comment">#<sp/>from<sp/>tqdm<sp/>import<sp/>tqdm</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>types<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>NoneType</highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>_brush</highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.deap_api<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>nsga2,<sp/>DeapIndividual<sp/></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="comment">#<sp/>from<sp/>_brush<sp/>import<sp/>Dataset,<sp/>SearchSpace</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight></codeline>
<codeline lineno="20" refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator" kindref="compound">BrushEstimator</ref>(BaseEstimator):</highlight></codeline>
<codeline lineno="21"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="22"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>This<sp/>is<sp/>the<sp/>base<sp/>class<sp/>for<sp/>Brush<sp/>estimators.<sp/></highlight></codeline>
<codeline lineno="23"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>This<sp/>class<sp/>shouldn&apos;t<sp/>be<sp/>called<sp/>directly;<sp/>instead,<sp/>call<sp/>a<sp/>child<sp/>class<sp/>like<sp/></highlight></codeline>
<codeline lineno="24"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>:py:class:`BrushRegressor<sp/>&lt;brush.estimator.BrushRegressor&gt;`<sp/>or<sp/>:py:class:`BrushClassifier<sp/>&lt;brush.estimator.BrushClassifier&gt;`.<sp/></highlight></codeline>
<codeline lineno="25"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>All<sp/>of<sp/>the<sp/>shared<sp/>parameters<sp/>are<sp/>documented<sp/>here.<sp/></highlight></codeline>
<codeline lineno="26"><highlight class="stringliteral"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="27"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="28"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Parameters</highlight></codeline>
<codeline lineno="29"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>----------</highlight></codeline>
<codeline lineno="30"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>mode<sp/>:<sp/>str,<sp/>default<sp/>&apos;classification&apos;</highlight></codeline>
<codeline lineno="31"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>The<sp/>mode<sp/>of<sp/>the<sp/>estimator.<sp/>Used<sp/>by<sp/>subclasses</highlight></codeline>
<codeline lineno="32"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>pop_size<sp/>:<sp/>int,<sp/>default<sp/>100</highlight></codeline>
<codeline lineno="33"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Population<sp/>size.</highlight></codeline>
<codeline lineno="34"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>max_gen<sp/>:<sp/>int,<sp/>default<sp/>100</highlight></codeline>
<codeline lineno="35"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Maximum<sp/>iterations<sp/>of<sp/>the<sp/>algorithm.</highlight></codeline>
<codeline lineno="36"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>verbosity<sp/>:<sp/>int,<sp/>default<sp/>0</highlight></codeline>
<codeline lineno="37"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Controls<sp/>level<sp/>of<sp/>printouts.</highlight></codeline>
<codeline lineno="38"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>max_depth<sp/>:<sp/>int,<sp/>default<sp/>0</highlight></codeline>
<codeline lineno="39"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Maximum<sp/>depth<sp/>of<sp/>GP<sp/>trees<sp/>in<sp/>the<sp/>GP<sp/>program.<sp/>Use<sp/>0<sp/>for<sp/>no<sp/>limit.</highlight></codeline>
<codeline lineno="40"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>max_size<sp/>:<sp/>int,<sp/>default<sp/>0</highlight></codeline>
<codeline lineno="41"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Maximum<sp/>number<sp/>of<sp/>nodes<sp/>in<sp/>a<sp/>tree.<sp/>Use<sp/>0<sp/>for<sp/>no<sp/>limit.</highlight></codeline>
<codeline lineno="42"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>mutation_options<sp/>:<sp/>dict,<sp/>default<sp/>{&quot;point&quot;:0.5,<sp/>&quot;insert&quot;:<sp/>0.25,<sp/>&quot;delete&quot;:<sp/><sp/>0.25}</highlight></codeline>
<codeline lineno="43"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>A<sp/>dictionary<sp/>with<sp/>keys<sp/>naming<sp/>the<sp/>types<sp/>of<sp/>mutation<sp/>and<sp/>floating<sp/>point<sp/></highlight></codeline>
<codeline lineno="44"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values<sp/>specifying<sp/>the<sp/>fraction<sp/>of<sp/>total<sp/>mutations<sp/>to<sp/>do<sp/>with<sp/>that<sp/>method.<sp/></highlight></codeline>
<codeline lineno="45"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>functions:<sp/>dict[str,float]<sp/>or<sp/>list[str],<sp/>default<sp/>{}</highlight></codeline>
<codeline lineno="46"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>A<sp/>dictionary<sp/>with<sp/>keys<sp/>naming<sp/>the<sp/>function<sp/>set<sp/>and<sp/>values<sp/>giving<sp/>the<sp/>probability<sp/>of<sp/>sampling<sp/>them,<sp/>or<sp/>a<sp/>list<sp/>of<sp/>functions<sp/>which<sp/>will<sp/>be<sp/>weighted<sp/>uniformly.</highlight></codeline>
<codeline lineno="47"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>If<sp/>empty,<sp/>all<sp/>available<sp/>functions<sp/>are<sp/>included<sp/>in<sp/>the<sp/>search<sp/>space.</highlight></codeline>
<codeline lineno="48"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="49"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Attributes</highlight></codeline>
<codeline lineno="50"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>----------</highlight></codeline>
<codeline lineno="51"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>best_estimator_<sp/>:<sp/>_brush.Program</highlight></codeline>
<codeline lineno="52"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>The<sp/>final<sp/>model<sp/>picked<sp/>from<sp/>training.<sp/>Used<sp/>in<sp/>subsequent<sp/>calls<sp/>to<sp/>:func:`predict`.<sp/></highlight></codeline>
<codeline lineno="53"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>archive_<sp/>:<sp/>list[deap_api.DeapIndividual]</highlight></codeline>
<codeline lineno="54"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>The<sp/>final<sp/>population<sp/>from<sp/>training.<sp/></highlight></codeline>
<codeline lineno="55"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>data_<sp/>:<sp/>_brush.Dataset</highlight></codeline>
<codeline lineno="56"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>The<sp/>training<sp/>data<sp/>in<sp/>Brush<sp/>format.<sp/></highlight></codeline>
<codeline lineno="57"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>search_space_<sp/>:<sp/>a<sp/>Brush<sp/>`SearchSpace`<sp/>object.<sp/></highlight></codeline>
<codeline lineno="58"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Holds<sp/>the<sp/>operators<sp/>and<sp/>terminals<sp/>and<sp/>sampling<sp/>utilities<sp/>to<sp/>update<sp/>programs.</highlight></codeline>
<codeline lineno="59"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>toolbox_<sp/>:<sp/>deap.Toolbox</highlight></codeline>
<codeline lineno="60"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>The<sp/>toolbox<sp/>used<sp/>by<sp/>DEAP<sp/>for<sp/>EA<sp/>algorithm.<sp/></highlight></codeline>
<codeline lineno="61"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="62"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="64" refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a118d108e81e36cbd8a28b670eba7f9e0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a118d108e81e36cbd8a28b670eba7f9e0" kindref="member">__init__</ref>(</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,<sp/></highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mode=&apos;classification&apos;,</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pop_size=100,</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>max_gen=100,</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>verbosity=0,</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>max_depth=3,</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>max_size=20,</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mutation_options<sp/>=<sp/>{&quot;point&quot;:0.4,<sp/></highlight><highlight class="stringliteral">&quot;insert&quot;</highlight><highlight class="normal">:<sp/>0.25,<sp/></highlight><highlight class="stringliteral">&quot;delete&quot;</highlight><highlight class="normal">:<sp/><sp/>0.25,<sp/></highlight><highlight class="stringliteral">&quot;toggle_weight&quot;</highlight><highlight class="normal">:<sp/>0.1},</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>functions:<sp/>list[str]|dict[str,float]<sp/>=<sp/>{},</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>batch_size:<sp/>int<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>):</highlight></codeline>
<codeline lineno="76" refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1ab2416cb2e4a9327b93fe8397d0ba8572" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1ab2416cb2e4a9327b93fe8397d0ba8572" kindref="member">pop_size</ref>pop_size=pop_size</highlight></codeline>
<codeline lineno="77" refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a3b4adff253c20efd315e9f8789503b4b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a3b4adff253c20efd315e9f8789503b4b" kindref="member">max_gen</ref>max_gen=max_gen</highlight></codeline>
<codeline lineno="78" refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a0d186a49025ec8370f4c5b2c61d1304f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a0d186a49025ec8370f4c5b2c61d1304f" kindref="member">verbosity</ref>verbosity=verbosity</highlight></codeline>
<codeline lineno="79" refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a5d1704a652d6d5ea0e5e98125702719a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a5d1704a652d6d5ea0e5e98125702719a" kindref="member">mode</ref>mode=mode</highlight></codeline>
<codeline lineno="80" refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a2526c6813d622c1ac125e5fb7b6ba128" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a2526c6813d622c1ac125e5fb7b6ba128" kindref="member">max_depth</ref>max_depth=max_depth</highlight></codeline>
<codeline lineno="81" refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1af75977b66a8836d700221adcb701b067" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1af75977b66a8836d700221adcb701b067" kindref="member">max_size</ref>max_size=max_size</highlight></codeline>
<codeline lineno="82" refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a0174bd91eccdf68b8885ae6b5ef4db76" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a0174bd91eccdf68b8885ae6b5ef4db76" kindref="member">mutation_options</ref>mutation_options=mutation_options</highlight></codeline>
<codeline lineno="83" refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1af9065286a6d4c5f2dcd6e3bcc539c08b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1af9065286a6d4c5f2dcd6e3bcc539c08b" kindref="member">functions</ref>functions=functions</highlight></codeline>
<codeline lineno="84" refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1aa71f7e6d68f5ce219d65b7f7b863fa6e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1aa71f7e6d68f5ce219d65b7f7b863fa6e" kindref="member">batch_size</ref>batch_size=batch_size</highlight></codeline>
<codeline lineno="85"><highlight class="normal"></highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight></codeline>
<codeline lineno="87" refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a546c6a6230b2d4f9a960b38596f54820" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a546c6a6230b2d4f9a960b38596f54820" kindref="member">_setup_toolbox</ref>(self,<sp/>data):</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Setup<sp/>the<sp/>deap<sp/>toolbox&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>toolbox:<sp/>base.Toolbox<sp/>=<sp/>base.Toolbox()</highlight></codeline>
<codeline lineno="90"><highlight class="normal"></highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>minimize<sp/>MAE,<sp/>minimize<sp/>size</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>creator.create(</highlight><highlight class="stringliteral">&quot;FitnessMulti&quot;</highlight><highlight class="normal">,<sp/>base.Fitness,<sp/>weights=(-1.0,-1.0))</highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>create<sp/>Individual<sp/>class,<sp/>inheriting<sp/>from<sp/>self.Individual<sp/>with<sp/>a<sp/>fitness<sp/>attribute</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>creator.create(</highlight><highlight class="stringliteral">&quot;Individual&quot;</highlight><highlight class="normal">,<sp/>DeapIndividual,<sp/>fitness=creator.FitnessMulti)<sp/><sp/></highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>toolbox.register(</highlight><highlight class="stringliteral">&quot;mate&quot;</highlight><highlight class="normal">,<sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1af7d065d73b3f1ec7f9e11799167da014" kindref="member">_crossover</ref>_crossover)</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>toolbox.register(</highlight><highlight class="stringliteral">&quot;mutate&quot;</highlight><highlight class="normal">,<sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a8edd942e828516255af2ae908a8e4666" kindref="member">_mutate</ref>_mutate)</highlight></codeline>
<codeline lineno="99"><highlight class="normal"></highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>toolbox.register(</highlight><highlight class="stringliteral">&quot;select&quot;</highlight><highlight class="normal">,<sp/>tools.selTournamentDCD)<sp/></highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>toolbox.register(</highlight><highlight class="stringliteral">&quot;survive&quot;</highlight><highlight class="normal">,<sp/>tools.selNSGA2)</highlight></codeline>
<codeline lineno="102"><highlight class="normal"></highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>toolbox.population<sp/>will<sp/>return<sp/>a<sp/>list<sp/>of<sp/>elements<sp/>by<sp/>calling<sp/>toolbox.individual</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>toolbox.register(</highlight><highlight class="stringliteral">&quot;population&quot;</highlight><highlight class="normal">,<sp/>tools.initRepeat,<sp/>list,<sp/>self._make_individual)</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>toolbox.register(<sp/></highlight><highlight class="stringliteral">&quot;evaluate&quot;</highlight><highlight class="normal">,<sp/>self._fitness_function,<sp/>data=data)</highlight></codeline>
<codeline lineno="106"><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>toolbox</highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight></codeline>
<codeline lineno="109" refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1af7d065d73b3f1ec7f9e11799167da014" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1af7d065d73b3f1ec7f9e11799167da014" kindref="member">_crossover</ref>(self,<sp/>ind1,<sp/>ind2):</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offspring<sp/>=<sp/>[]<sp/></highlight></codeline>
<codeline lineno="111"><highlight class="normal"></highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i,j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>[(ind1,ind2),(ind2,ind1)]:</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>off<sp/>=<sp/>creator.Individual(i.prg.cross(j.prg))</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>off.fitness.valid<sp/>=<sp/>False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offspring.append(off)</highlight></codeline>
<codeline lineno="116"><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>offspring[0],<sp/>offspring[1]</highlight></codeline>
<codeline lineno="118"><highlight class="normal"></highlight></codeline>
<codeline lineno="119" refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a8edd942e828516255af2ae908a8e4666" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a8edd942e828516255af2ae908a8e4666" kindref="member">_mutate</ref>(self,<sp/>ind1):</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>offspring<sp/>=<sp/>(creator.Individual(ind1.prg.mutate(self.search_space_)),)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offspring<sp/>=<sp/>creator.Individual(ind1.prg.mutate())</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>offspring</highlight></codeline>
<codeline lineno="123"><highlight class="normal"></highlight></codeline>
<codeline lineno="124" refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a86918636dd7cd887005649b62d14d1be" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a86918636dd7cd887005649b62d14d1be" kindref="member">fit</ref>(self,<sp/>X,<sp/>y):</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="126"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Fit<sp/>an<sp/>estimator<sp/>to<sp/>X,y.</highlight></codeline>
<codeline lineno="127"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="128"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Parameters</highlight></codeline>
<codeline lineno="129"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>----------</highlight></codeline>
<codeline lineno="130"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>X<sp/>:<sp/>np.ndarray</highlight></codeline>
<codeline lineno="131"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2-d<sp/>array<sp/>of<sp/>input<sp/>data.</highlight></codeline>
<codeline lineno="132"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y<sp/>:<sp/>np.ndarray</highlight></codeline>
<codeline lineno="133"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1-d<sp/>array<sp/>of<sp/>(boolean)<sp/>target<sp/>values.</highlight></codeline>
<codeline lineno="134"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_brush.set_params(self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a3808a9773d5a42827cc28aaf3f97b694" kindref="member">get_params</ref>get_params())</highlight></codeline>
<codeline lineno="136" refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a0a312180a4bb723670ab37a417074a0e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a0a312180a4bb723670ab37a417074a0e" kindref="member">data_</ref>data_<sp/>=<sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a8ee87e403b46c4f0d3c718a2c3fdc988" kindref="member">_make_data</ref>_make_data(X,y)</highlight></codeline>
<codeline lineno="137"><highlight class="normal"></highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>set<sp/>n<sp/>classes<sp/>if<sp/>relevant</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a5d1704a652d6d5ea0e5e98125702719a" kindref="member">mode</ref>mode==</highlight><highlight class="stringliteral">&quot;classification&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="140" refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a0b22b0ef09f113dfd3871d328090499c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a0b22b0ef09f113dfd3871d328090499c" kindref="member">n_classes_</ref>n_classes_<sp/>=<sp/>len(np.unique(y))</highlight></codeline>
<codeline lineno="141"><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1af9065286a6d4c5f2dcd6e3bcc539c08b" kindref="member">functions</ref>functions,<sp/>list):</highlight></codeline>
<codeline lineno="143" refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1ab25513e9cb65475b41f18804257a49b6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1ab25513e9cb65475b41f18804257a49b6" kindref="member">functions_</ref>functions_<sp/>=<sp/>{k:1.0<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1af9065286a6d4c5f2dcd6e3bcc539c08b" kindref="member">functions</ref>functions}</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1ab25513e9cb65475b41f18804257a49b6" kindref="member">functions_</ref>functions_<sp/>=<sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1af9065286a6d4c5f2dcd6e3bcc539c08b" kindref="member">functions</ref>functions</highlight></codeline>
<codeline lineno="146"><highlight class="normal"></highlight></codeline>
<codeline lineno="147" refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1ae60d91755de9e541295e25c49ecfb591" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1ae60d91755de9e541295e25c49ecfb591" kindref="member">search_space_</ref>search_space_<sp/>=<sp/>_brush.SearchSpace(self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a0a312180a4bb723670ab37a417074a0e" kindref="member">data_</ref>data_,<sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1ab25513e9cb65475b41f18804257a49b6" kindref="member">functions_</ref>functions_)</highlight></codeline>
<codeline lineno="148" refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1ab7642f08b6d239392ecaa4a78b730957" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1ab7642f08b6d239392ecaa4a78b730957" kindref="member">toolbox_</ref>toolbox_<sp/>=<sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a546c6a6230b2d4f9a960b38596f54820" kindref="member">_setup_toolbox</ref>_setup_toolbox(data=self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a0a312180a4bb723670ab37a417074a0e" kindref="member">data_</ref>data_)</highlight></codeline>
<codeline lineno="149"><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>archive,<sp/>logbook<sp/>=<sp/><ref refid="d1/d49/namespacebrush_1_1deap__api_1_1nsga2_1a28c2ecf4b42f4456d964b7a6adce55e0" kindref="member">nsga2</ref>(self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1ab7642f08b6d239392ecaa4a78b730957" kindref="member">toolbox_</ref>toolbox_,<sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a3b4adff253c20efd315e9f8789503b4b" kindref="member">max_gen</ref>max_gen,<sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1ab2416cb2e4a9327b93fe8397d0ba8572" kindref="member">pop_size</ref>pop_size,<sp/>0.9,<sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a0d186a49025ec8370f4c5b2c61d1304f" kindref="member">verbosity</ref>verbosity)</highlight></codeline>
<codeline lineno="151" refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1ada78ab3e85a2edecbd8bf256009f014c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1ada78ab3e85a2edecbd8bf256009f014c" kindref="member">archive_</ref>archive_<sp/>=<sp/>archive</highlight></codeline>
<codeline lineno="152" refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a44422c9d94c587951537f62fdfe95739" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a44422c9d94c587951537f62fdfe95739" kindref="member">best_estimator_</ref>best_estimator_<sp/>=<sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1ada78ab3e85a2edecbd8bf256009f014c" kindref="member">archive_</ref>archive_[0].prg</highlight></codeline>
<codeline lineno="153"><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d2e/namespaceBrush_1_1Util_1a0fca88a717680a76c4b7b9b082675f89" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&apos;best<sp/>model:&apos;</highlight><highlight class="normal">,self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a44422c9d94c587951537f62fdfe95739" kindref="member">best_estimator_</ref>best_estimator_.get_model())</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="157" refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a8ee87e403b46c4f0d3c718a2c3fdc988" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a8ee87e403b46c4f0d3c718a2c3fdc988" kindref="member">_make_data</ref>(self,<sp/>X,<sp/>y=None):</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(y,<sp/>pd.Series):</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y<sp/>=<sp/>y.values</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(X,<sp/>pd.DataFrame):</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>self.data_<sp/>=<sp/>_brush.Dataset(X.to_dict(orient=&apos;list&apos;),<sp/>y)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>feature_names<sp/>=<sp/>X.columns.to_list()</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>X<sp/>=<sp/>X.values</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(y,<sp/>NoneType):</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>_brush.Dataset(X,<sp/>feature_names)</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>_brush.Dataset(X,<sp/>y,<sp/>feature_names)</highlight></codeline>
<codeline lineno="168"><highlight class="normal"></highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">assert</highlight><highlight class="normal"><sp/>isinstance(X,<sp/>np.ndarray)</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>if<sp/>there<sp/>is<sp/>no<sp/>label,<sp/>don&apos;t<sp/>include<sp/>it<sp/>in<sp/>library<sp/>call<sp/>to<sp/>Dataset</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(y,<sp/>NoneType):</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>_brush.Dataset(X)</highlight></codeline>
<codeline lineno="173"><highlight class="normal"></highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>_brush.Dataset(X,y)</highlight></codeline>
<codeline lineno="175"><highlight class="normal"></highlight></codeline>
<codeline lineno="176" refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a87709a26a92ac4e24a4f3106b2bdd139" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a87709a26a92ac4e24a4f3106b2bdd139" kindref="member">predict</ref>(self,<sp/>X):</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Predict<sp/>using<sp/>the<sp/>best<sp/>estimator<sp/>in<sp/>the<sp/>archive.<sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data<sp/>=<sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a8ee87e403b46c4f0d3c718a2c3fdc988" kindref="member">_make_data</ref>_make_data(X)</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a44422c9d94c587951537f62fdfe95739" kindref="member">best_estimator_</ref>best_estimator_.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a87709a26a92ac4e24a4f3106b2bdd139" kindref="member">predict</ref>(data)</highlight></codeline>
<codeline lineno="180"><highlight class="normal"></highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>def<sp/>_setup_population(self):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;initialize<sp/>programs&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>if<sp/>self.mode<sp/>==<sp/>&apos;classification&apos;:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>generate<sp/>=<sp/>self.search_space_.make_classifier</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>else:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>generate<sp/>=<sp/>self.search_space_.make_regressor</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="187"><highlight class="normal"></highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>programs<sp/>=<sp/>[</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DeapIndividual(generate(self.max_depth,<sp/>self.max_size))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>i<sp/>in<sp/>range(self.pop_size)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>#<sp/>return<sp/>[self._create_deap_individual_(p)<sp/>for<sp/>p<sp/>in<sp/>programs]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>return<sp/>programs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="194"><highlight class="normal"></highlight></codeline>
<codeline lineno="195" refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a3808a9773d5a42827cc28aaf3f97b694" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a3808a9773d5a42827cc28aaf3f97b694" kindref="member">get_params</ref>(self):</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>{k:v<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k,v<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.__dict__.items()<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>k.endswith(</highlight><highlight class="stringliteral">&apos;_&apos;</highlight><highlight class="normal">)}</highlight></codeline>
<codeline lineno="197"><highlight class="normal"></highlight></codeline>
<codeline lineno="198" refid="d0/d6a/classbrush_1_1estimator_1_1BrushClassifier" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d0/d6a/classbrush_1_1estimator_1_1BrushClassifier" kindref="compound">BrushClassifier</ref>(<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator" kindref="compound">BrushEstimator</ref>,ClassifierMixin):</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Brush<sp/>for<sp/>classification.</highlight></codeline>
<codeline lineno="200"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="201"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>For<sp/>options,<sp/>see<sp/>:py:class:`BrushEstimator<sp/>&lt;brush.estimator.BrushEstimator&gt;`.<sp/></highlight></codeline>
<codeline lineno="202"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="203"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Examples</highlight></codeline>
<codeline lineno="204"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>--------</highlight></codeline>
<codeline lineno="205"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>import<sp/>pandas<sp/>as<sp/>pd</highlight></codeline>
<codeline lineno="206"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>df<sp/>=<sp/>pd.read_csv(&apos;docs/examples/datasets/d_analcatdata_aids.csv&apos;)</highlight></codeline>
<codeline lineno="207"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>X<sp/>=<sp/>df.drop(columns=&apos;target&apos;)</highlight></codeline>
<codeline lineno="208"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>y<sp/>=<sp/>df[&apos;target&apos;]</highlight></codeline>
<codeline lineno="209"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>from<sp/>brush<sp/>import<sp/>BrushClassifier</highlight></codeline>
<codeline lineno="210"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>est<sp/>=<sp/>BrushClassifier()</highlight></codeline>
<codeline lineno="211"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>est.fit(X,y)</highlight></codeline>
<codeline lineno="212"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>print(&apos;score:&apos;,<sp/>est.score(X,y))</highlight></codeline>
<codeline lineno="213"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="214" refid="d0/d6a/classbrush_1_1estimator_1_1BrushClassifier_1af96b165dab470191a26fcd9a87908040" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d0/d6a/classbrush_1_1estimator_1_1BrushClassifier_1af96b165dab470191a26fcd9a87908040" kindref="member">__init__</ref>(<sp/>self,<sp/>**kwargs):</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>super().<ref refid="d0/d6a/classbrush_1_1estimator_1_1BrushClassifier_1af96b165dab470191a26fcd9a87908040" kindref="member">__init__</ref>(mode=</highlight><highlight class="stringliteral">&apos;classification&apos;</highlight><highlight class="normal">,**kwargs)</highlight></codeline>
<codeline lineno="216"><highlight class="normal"></highlight></codeline>
<codeline lineno="217" refid="d0/d6a/classbrush_1_1estimator_1_1BrushClassifier_1a57f9821e2eb132e67a4dcbd97ffa472f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d0/d6a/classbrush_1_1estimator_1_1BrushClassifier_1a57f9821e2eb132e67a4dcbd97ffa472f" kindref="member">_fitness_function</ref>(self,<sp/>ind,<sp/>data:<sp/>_brush.Dataset):</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ind.prg.fit(data)</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>np.abs(data.y-ind.prg.predict(data)).sum(),<sp/></highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ind.prg.size()</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="224" refid="d0/d6a/classbrush_1_1estimator_1_1BrushClassifier_1a2f7af58230ed6d27a92c6c727b600820" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d0/d6a/classbrush_1_1estimator_1_1BrushClassifier_1a2f7af58230ed6d27a92c6c727b600820" kindref="member">_make_individual</ref>(self):</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>creator.Individual(</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1ae60d91755de9e541295e25c49ecfb591" kindref="member">search_space_</ref>search_space_.make_classifier(self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a2526c6813d622c1ac125e5fb7b6ba128" kindref="member">max_depth</ref>max_depth,<sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1af75977b66a8836d700221adcb701b067" kindref="member">max_size</ref>max_size)</highlight></codeline>
<codeline lineno="227" refid="d0/d6a/classbrush_1_1estimator_1_1BrushClassifier_1aca99ed7b077b0023be91bbf4609511c1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a0b22b0ef09f113dfd3871d328090499c" kindref="member">n_classes_</ref><ref refid="d0/d6a/classbrush_1_1estimator_1_1BrushClassifier_1aca99ed7b077b0023be91bbf4609511c1" kindref="member">n_classes_</ref>n_classes_<sp/>==<sp/>2<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1ae60d91755de9e541295e25c49ecfb591" kindref="member">search_space_</ref>search_space_.make_multiclass_classifier(self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a2526c6813d622c1ac125e5fb7b6ba128" kindref="member">max_depth</ref>max_depth,<sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1af75977b66a8836d700221adcb701b067" kindref="member">max_size</ref>max_size)</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="230"><highlight class="normal"></highlight></codeline>
<codeline lineno="231" refid="d0/d6a/classbrush_1_1estimator_1_1BrushClassifier_1a0a089fd905951f470a57fd267890511c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d0/d6a/classbrush_1_1estimator_1_1BrushClassifier_1a0a089fd905951f470a57fd267890511c" kindref="member">predict_proba</ref>(self,<sp/>X):</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Predict<sp/>class<sp/>probabilities<sp/>for<sp/>X.</highlight></codeline>
<codeline lineno="233"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="234"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Parameters</highlight></codeline>
<codeline lineno="235"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>----------</highlight></codeline>
<codeline lineno="236"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>X<sp/>:<sp/>{array-like,<sp/>sparse<sp/>matrix}<sp/>of<sp/>shape<sp/>(n_samples,<sp/>n_features)</highlight></codeline>
<codeline lineno="237"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>The<sp/>input<sp/>samples.<sp/>Internally,<sp/>it<sp/>will<sp/>be<sp/>converted<sp/>to</highlight></codeline>
<codeline lineno="238"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>``dtype=np.float32``.</highlight></codeline>
<codeline lineno="239"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="240"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns</highlight></codeline>
<codeline lineno="241"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-------</highlight></codeline>
<codeline lineno="242"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>:<sp/>ndarray<sp/>of<sp/>shape<sp/>(n_samples,<sp/>n_classes)</highlight></codeline>
<codeline lineno="243"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>The<sp/>class<sp/>probabilities<sp/>of<sp/>the<sp/>input<sp/>samples.<sp/>The<sp/>order<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="244"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>classes<sp/>corresponds<sp/>to<sp/>that<sp/>in<sp/>the<sp/>attribute<sp/>:term:`classes_`.</highlight></codeline>
<codeline lineno="245"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="246"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data<sp/>=<sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a8ee87e403b46c4f0d3c718a2c3fdc988" kindref="member">_make_data</ref>_make_data(X)</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a44422c9d94c587951537f62fdfe95739" kindref="member">best_estimator_</ref>best_estimator_.<ref refid="d0/d6a/classbrush_1_1estimator_1_1BrushClassifier_1a0a089fd905951f470a57fd267890511c" kindref="member">predict_proba</ref>(data)</highlight></codeline>
<codeline lineno="249"><highlight class="normal"></highlight></codeline>
<codeline lineno="250" refid="da/d81/classbrush_1_1estimator_1_1BrushRegressor" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="da/d81/classbrush_1_1estimator_1_1BrushRegressor" kindref="compound">BrushRegressor</ref>(<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator" kindref="compound">BrushEstimator</ref>,<sp/>RegressorMixin):</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Brush<sp/>for<sp/>regression.</highlight></codeline>
<codeline lineno="252"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="253"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>For<sp/>options,<sp/>see<sp/>:py:class:`BrushEstimator<sp/>&lt;brush.estimator.BrushEstimator&gt;`.<sp/></highlight></codeline>
<codeline lineno="254"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="255"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Examples</highlight></codeline>
<codeline lineno="256"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>--------</highlight></codeline>
<codeline lineno="257"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>import<sp/>pandas<sp/>as<sp/>pd</highlight></codeline>
<codeline lineno="258"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>df<sp/>=<sp/>pd.read_csv(&apos;docs/examples/datasets/d_enc.csv&apos;)</highlight></codeline>
<codeline lineno="259"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>X<sp/>=<sp/>df.drop(columns=&apos;label&apos;)</highlight></codeline>
<codeline lineno="260"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>y<sp/>=<sp/>df[&apos;label&apos;]</highlight></codeline>
<codeline lineno="261"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>from<sp/>brush<sp/>import<sp/>BrushRegressor</highlight></codeline>
<codeline lineno="262"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>est<sp/>=<sp/>BrushRegressor()</highlight></codeline>
<codeline lineno="263"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>est.fit(X,y)</highlight></codeline>
<codeline lineno="264"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>print(&apos;score:&apos;,<sp/>est.score(X,y))</highlight></codeline>
<codeline lineno="265"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="266" refid="da/d81/classbrush_1_1estimator_1_1BrushRegressor_1a8f27759d9f9dbd6cc519a867e6a5822e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/d81/classbrush_1_1estimator_1_1BrushRegressor_1a8f27759d9f9dbd6cc519a867e6a5822e" kindref="member">__init__</ref>(self,<sp/>**kwargs):</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>super().<ref refid="da/d81/classbrush_1_1estimator_1_1BrushRegressor_1a8f27759d9f9dbd6cc519a867e6a5822e" kindref="member">__init__</ref>(mode=</highlight><highlight class="stringliteral">&apos;regressor&apos;</highlight><highlight class="normal">,**kwargs)</highlight></codeline>
<codeline lineno="268"><highlight class="normal"></highlight></codeline>
<codeline lineno="269" refid="da/d81/classbrush_1_1estimator_1_1BrushRegressor_1ac1eabaaaed9126e30f5858da65daf472" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/d81/classbrush_1_1estimator_1_1BrushRegressor_1ac1eabaaaed9126e30f5858da65daf472" kindref="member">_fitness_function</ref>(self,<sp/>ind,<sp/>data:<sp/>_brush.Dataset):</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ind.prg.fit(data)</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>np.sum((data.y-<sp/>ind.prg.predict(data))**2),</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ind.prg.size()</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="275"><highlight class="normal"></highlight></codeline>
<codeline lineno="276" refid="da/d81/classbrush_1_1estimator_1_1BrushRegressor_1aa2445be9821177293be3585174333928" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/d81/classbrush_1_1estimator_1_1BrushRegressor_1aa2445be9821177293be3585174333928" kindref="member">_make_individual</ref>(self):</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>creator.Individual(</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1ae60d91755de9e541295e25c49ecfb591" kindref="member">search_space_</ref>search_space_.make_regressor(self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1a2526c6813d622c1ac125e5fb7b6ba128" kindref="member">max_depth</ref>max_depth,<sp/>self.<ref refid="d0/dc4/classbrush_1_1estimator_1_1BrushEstimator_1af75977b66a8836d700221adcb701b067" kindref="member">max_size</ref>max_size)</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="280"><highlight class="normal"></highlight></codeline>
<codeline lineno="281"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Under<sp/>development</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="282"><highlight class="normal"></highlight><highlight class="comment">#<sp/>class<sp/>BrushRepresenter(BrushEstimator,<sp/>TransformerMixin):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="283"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Brush<sp/>for<sp/>representation<sp/>learning.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="284"><highlight class="normal"></highlight></codeline>
<codeline lineno="285"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>For<sp/>options,<sp/>see<sp/>:py:class:`BrushEstimator<sp/>&lt;brush.estimator.BrushEstimator&gt;`.<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="286"><highlight class="normal"></highlight></codeline>
<codeline lineno="287"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>Examples</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="288"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>--------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="289"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>import<sp/>pandas<sp/>as<sp/>pd</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="290"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>df<sp/>=<sp/>pd.read_csv(&apos;docs/examples/datasets/d_enc.csv&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="291"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>X<sp/>=<sp/>df.drop(columns=&apos;label&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="292"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>y<sp/>=<sp/>df[&apos;label&apos;]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="293"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>from<sp/>brush<sp/>import<sp/>BrushRegressor</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="294"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>est<sp/>=<sp/>BrushRegressor()</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="295"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>est.fit(X,y)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="296"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>&gt;&gt;&gt;<sp/>print(&apos;score:&apos;,<sp/>est.score(X,y))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="297"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="298"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>def<sp/>__init__(self,<sp/>**kwargs):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="299"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>super().__init__(mode=&apos;regressor&apos;,**kwargs)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="300"><highlight class="normal"></highlight></codeline>
<codeline lineno="301"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>def<sp/>_fitness_function(self,<sp/>ind,<sp/>data:<sp/>_brush.Dataset):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="302"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ind.prg.fit(data)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="303"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>(</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="304"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>todo:<sp/>need<sp/>to<sp/>return<sp/>a<sp/>matrix<sp/>from<sp/>X<sp/>for<sp/>this</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="305"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>np.sum((data.get_X()-<sp/>ind.prg.predict(data))**2),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="306"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ind.prg.size()</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="307"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="308"><highlight class="normal"></highlight></codeline>
<codeline lineno="309"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>def<sp/>_make_individual(self):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="310"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>creator.Individual(</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="311"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.search_space_.make_representer(self.max_depth,<sp/>self.max_size)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="312"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="313"><highlight class="normal"></highlight></codeline>
<codeline lineno="314"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>def<sp/>transform(self,<sp/>X):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="315"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;Transform<sp/>X<sp/>using<sp/>the<sp/>best<sp/>estimator<sp/>in<sp/>the<sp/>archive.<sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="316"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>self.predict(X)</highlight></codeline>
    </programlisting>
    <location file="/home/runner/work/brush/brush/src/brush/estimator.py"/>
  </compounddef>
</doxygen>
